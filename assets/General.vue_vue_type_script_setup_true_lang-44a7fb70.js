import{d as X,r as p,a as le,j as oe,o as Y,b as _,c as a,e as c,h as e,f as s,w as i,t as x,i as j,m as w,n as S,k as g,g as U,F as B,l as I,u as te}from"./index-5c8bf84e.js";import{_ as W,u as se,n as ae,g as ne,d as ue}from"./InputAddress.vue_vue_type_style_index_0_lang-f9f1dae0.js";import{o as de,a as re}from"./helpers-a12fb3e4.js";import{l as z}from"./lodash-2dc3c718.js";const ie={class:"bg-blue-50"},ce=e("div",{class:"mb-4"},[e("div",{class:"flex justify-between align-center justify-center"},[e("h1",{class:"h5 font-bold m-0"},"Nueva Ruta")])],-1),pe={class:"new-customer gap-8"},me={class:"w-full bg-white p-2 mt-3 mb-4 py-5"},_e={class:"gap-2"},ve={key:0,class:"text-xs font-bold uppercase"},fe={class:"bg-white columns-2 py-1 pb-3"},be={class:"columns-3 mb-4"},he=e("span",{class:"px-0 -mx-1 font-bold text-sm"},"S/",-1),ye=e("hr",null,null,-1),ge={class:"columns-2 mt-4 gap-0"},xe={class:"bg-gray-100 py-1"},Ve={class:"font-bold text-black text-sm text-center"},ke=e("span",{class:"uppercase text-xs"},"(Ida)",-1),Ce={class:"bg-blue-100 py-1"},$e={class:"font-bold text-black text-sm text-center"},we=e("span",{class:"uppercase text-xs"},"(Vuelta)",-1),je={class:"flex gap-0"},Ee={class:"flex flex-col w-1/2"},Ne={class:"flex gap-1 toll"},Re={class:"flex flex-col w-1/2"},qe={class:"flex gap-1 toll"},Se={class:"flex justify-end"},Ue={class:"flex gap-2"},Be=e("span",{class:"text-xs px-1"},"Guardar",-1),Ie=X({__name:"NewRoute",props:{data:{default:null,type:Object}},emits:["close"],setup(G,{emit:D}){const r=G,R=de,V=re,F=D,k=p(!1),b=p([]),h=p([]),{isValid:L,validate:q,reset:P}=le("formRef"),n=oe({}),C=p(null),E=p(null);Y(()=>{var d,o,f;r.data&&(n.baseprice=((d=r.data)==null?void 0:d.baseprice)||0,n.kilometers=((o=r.data)==null?void 0:o.kilometers)||0,n.hours=((f=r.data)==null?void 0:f.travelhours)||0,b.value=r.data.tolls.filter(l=>l.type==0).map(l=>({q:l.vehicle_type,amount:l.amount})),h.value=r.data.tolls.filter(l=>l.type==1).map(l=>({q:l.vehicle_type,amount:l.amount})))});const v=async()=>{var d;if(q()){k.value=!0;try{(d=r.data)!=null&&d.id?await se({kilometers:n.kilometers||0,baseprice:n.baseprice||0,travelhours:n.hours||0,tolls:{from:b.value.map(o=>({vehicle_type:o.q,amount:o.amount})),to:h.value.map(o=>({vehicle_type:o.q,amount:o.amount}))}},r.data.id):await ae({from:C.value.label,to:E.value.label,kilometers:n.kilometers||0,baseprice:n.baseprice||0,travelhours:n.hours||0,tolls:{from:b.value.map(o=>({vehicle_type:o.q,amount:o.amount})),to:h.value.map(o=>({vehicle_type:o.q,amount:o.amount}))}}),P(),F("close")}catch(o){console.log(o)}k.value=!1}},m=()=>{b.value.push({q:N[0],amount:0})},$=()=>{h.value.push({q:N[0],amount:0})},M=d=>{b.value.splice(d,1)},T=d=>{h.value.splice(d,1)},N=["Ligero","2 Ejes","3 Ejes","4 Ejes","5 Ejes","6 Ejes","7 Ejes","8 Ejes","9 Ejes","10 Ejes","11 Ejes","12 Ejes","13 Ejes","14 Ejes","15 Ejes"];return(d,o)=>{var H,K,A;const f=_("VaInput"),l=_("VaIcon"),u=_("VaSelect"),Z=_("VaForm"),ee=_("VaButton");return a(),c("div",ie,[ce,e("div",pe,[s(Z,{ref:"formRef",immediate:"",class:"gap-2"},{default:i(()=>{var J,Q;return[e("div",me,[e("div",_e,[d.$props.data?(a(),c("p",ve,x((J=d.$props.data)==null?void 0:J.from)+" / "+x((Q=d.$props.data)==null?void 0:Q.to),1)):j("",!0),e("div",fe,[e("div",null,[d.$props.data?j("",!0):(a(),w(W,{key:0,label:"Origen",onlyaddress:!0,nomaps:!0,onSelected:o[0]||(o[0]=t=>C.value=t)}))]),e("div",null,[d.$props.data?j("",!0):(a(),w(W,{key:0,label:"Destino",onlyaddress:!0,nomaps:!0,onSelected:o[1]||(o[1]=t=>E.value=t)}))])]),e("div",be,[e("div",null,[S((a(),w(f,{modelValue:n.baseprice,"onUpdate:modelValue":o[2]||(o[2]=t=>n.baseprice=t),label:"Precio base de Servicio",min:"0",onChange:o[3]||(o[3]=()=>{n.baseprice=g(z.ceil)(n.baseprice,2)})},{prependInner:i(()=>[he]),_:1},8,["modelValue"])),[[g(R)]])]),e("div",null,[S(s(f,{modelValue:n.kilometers,"onUpdate:modelValue":o[4]||(o[4]=t=>n.kilometers=t),label:"Kilometros",type:"number",min:"0"},null,8,["modelValue"]),[[g(V)]])]),e("div",null,[S(s(f,{modelValue:n.hours,"onUpdate:modelValue":o[5]||(o[5]=t=>n.hours=t),label:"Horas de Viaje",type:"number",min:".5"},null,8,["modelValue"]),[[g(V)]])])]),ye,e("div",ge,[e("div",xe,[e("p",Ve,[U(" Peajes "),ke,s(l,{color:"primary",name:"add_circle",class:"cursor-pointer ml-2",onClick:o[6]||(o[6]=t=>m())})])]),e("div",Ce,[e("p",$e,[U(" Peajes "),we,s(l,{color:"primary",name:"add_circle",class:"cursor-pointer ml-2",onClick:o[7]||(o[7]=t=>$())})])])]),e("div",je,[e("div",Ee,[(a(!0),c(B,null,I(b.value,(t,O)=>(a(),c("div",{key:t,class:"bg-gray-100 px-1 pb-1"},[e("div",Ne,[s(u,{modelValue:t.q,"onUpdate:modelValue":y=>t.q=y,class:"quantity text-xxs",options:N,placeholder:"Selecciona un tipo",background:"#fff"},null,8,["modelValue","onUpdate:modelValue"]),S((a(),w(f,{modelValue:t.amount,"onUpdate:modelValue":y=>t.amount=y,type:"text",class:"amount",background:"#fff",onChange:()=>{t.amount=g(z.ceil)(t.amount,2)}},{append:i(()=>[s(l,{name:"delete",class:"cursor-pointer ml-1 relative -left-0.5 mr-1",color:"danger",onClick:y=>M(O)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])),[[g(R)]])])]))),128))]),e("div",Re,[(a(!0),c(B,null,I(h.value,(t,O)=>(a(),c("div",{key:t,class:"flex flex-col bg-blue-100 pl-1 pr-3 pb-1"},[e("div",qe,[s(u,{modelValue:t.q,"onUpdate:modelValue":y=>t.q=y,class:"quantity text-xxs",options:N,placeholder:"Selecciona un tipo",background:"#fff"},null,8,["modelValue","onUpdate:modelValue"]),S((a(),w(f,{modelValue:t.amount,"onUpdate:modelValue":y=>t.amount=y,type:"text",class:"amount",background:"#fff",onChange:()=>{t.amount=g(z.ceil)(t.amount,2)}},{append:i(()=>[s(l,{name:"delete",class:"cursor-pointer ml-1 relative -left-0.5 mr-1",color:"danger",onClick:y=>T(O)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])),[[g(R)]])])]))),128))])])])])]}),_:1},512)]),e("div",null,[e("div",Se,[e("div",Ue,[s(ee,{icon:"save",color:"primary",disabled:!g(L)||!((H=d.$props.data)!=null&&H.id)&&(!((K=C.value)!=null&&K.label)||!((A=E.value)!=null&&A.label)),loading:k.value,onClick:v},{default:i(()=>[Be]),_:1},8,["disabled","loading"])])])])])}}});const Te={class:"flex flex-col space-y-6 md:space-y-4"},De=e("span",{class:"px-1"},"Nueva Ruta",-1),Fe={class:"flex flex-col p-4 bg-backgroundSecondary rounded-lg"},Le={class:"va-table-responsive"},Pe={class:"va-table w-full text-xs"},Me=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Origen"),e("th",null,"Destino"),e("th",null,"Kilometros"),e("th",null,"P. Base"),e("th",null,"Horas"),e("th",null,"Peajes"),e("th")])],-1),Oe={key:0,class:"m-0 font-bold text-xs"},ze={key:1,class:"bg-blue-100 px-2 pb-2 pt-1 rounded-md"},Ge={key:0},He=e("p",{class:"text-xs font-bold mb-1 px-1"},"Ida:",-1),Ke={key:1},Ae=e("p",{class:"text-xs font-bold mt-2 mb-1 px-1"},"Vuelta:",-1),Je={class:"flex gap-1"},Qe=e("p",{class:"text-sm"},"¿Deseas continuar?",-1),el=X({__name:"General",setup(G){const{notify:D}=te(),r=p(!1),R=p(!1),V=p(!1),F=p(!1),k=p(!1),b=p(null),h=p([]),L=()=>{r.value=!1,R.value=!1,q()};Y(()=>{q()});const q=async()=>{k.value=!0;const v=await ne();h.value=v,k.value=!1},P=async()=>{V.value=!1,await ue(b.value),D({message:"Ruta eliminada correctamente",color:"success"}),q()},n=v=>{b.value=v,V.value=!!v},C=p(null),E=v=>{v?(C.value=v,r.value=!0):(C.value=v,r.value=!1)};return(v,m)=>{const $=_("VaButton"),M=_("VaCardTitle"),T=_("VaBadge"),N=_("VaCardContent"),d=_("VaCard"),o=_("VaInnerLoading"),f=_("VaModal");return a(),c("div",Te,[s(o,{loading:k.value},{default:i(()=>[s(d,null,{default:i(()=>[s(M,{class:"d-flex justify-between"},{default:i(()=>[U(" Maestro de Rutas "),s($,{icon:"add",color:"primary",onClick:m[0]||(m[0]=l=>r.value=!0)},{default:i(()=>[De]),_:1})]),_:1}),s(N,null,{default:i(()=>[e("div",Fe,[e("div",Le,[e("table",Pe,[Me,e("tbody",null,[(a(!0),c(B,null,I(h.value,l=>(a(),c("tr",{key:l.id},[e("td",null,x(l.id),1),e("td",null,x(l.from),1),e("td",null,x(l.to),1),e("td",null,x(l.kilometers||"-"),1),e("td",null,"S/ "+x(l.baseprice),1),e("td",null,x(l.travelhours||"-"),1),e("td",null,[l.tolls.length?j("",!0):(a(),c("p",Oe,"Sin Información")),l.tolls.length?(a(),c("div",ze,[l.tolls.filter(u=>u.type===0).length?(a(),c("div",Ge,[He,(a(!0),c(B,null,I(l.tolls.filter(u=>u.type===0),u=>(a(),w(T,{key:u,text:"("+u.vehicle_type+") S/"+u.amount,color:"primary",class:"mr-2"},null,8,["text"]))),128))])):j("",!0),l.tolls.filter(u=>u.type===1).length?(a(),c("div",Ke,[Ae,(a(!0),c(B,null,I(l.tolls.filter(u=>u.type===1),u=>(a(),w(T,{key:u,text:"("+u.vehicle_type+") S/"+u.amount,color:"primary",class:"mr-2"},null,8,["text"]))),128))])):j("",!0)])):j("",!0)]),e("td",null,[e("div",Je,[s($,{icon:"edit",color:"primary",round:"",onClick:u=>E(l)},null,8,["onClick"]),s($,{icon:"delete",color:"danger",round:"",onClick:u=>n(l.id)},null,8,["onClick"])])])]))),128))])])])])]),_:1})]),_:1})]),_:1},8,["loading"]),s(f,{modelValue:r.value,"onUpdate:modelValue":m[1]||(m[1]=l=>r.value=l),size:"460px","close-button":"","hide-default-actions":"","no-dismiss":"",blur:"",onClose:m[2]||(m[2]=l=>E(null))},{default:i(()=>[e("div",null,[s(Ie,{data:C.value,onClose:L},null,8,["data"])])]),_:1},8,["modelValue"]),s(f,{modelValue:V.value,"onUpdate:modelValue":m[4]||(m[4]=l=>V.value=l),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:i(()=>[s($,{size:"small",preset:"secondary",class:"mr-1",onClick:m[3]||(m[3]=l=>n(null))},{default:i(()=>[U(" Cancelar")]),_:1}),s($,{size:"small",loading:F.value,onClick:P},{default:i(()=>[U(" Continuar")]),_:1},8,["loading"])]),default:i(()=>[Qe]),_:1},8,["modelValue"])])}}});export{el as _};
//# sourceMappingURL=General.vue_vue_type_script_setup_true_lang-44a7fb70.js.map
