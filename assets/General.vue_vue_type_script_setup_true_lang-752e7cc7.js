import{d as le,p as m,q as se,x as ne,s as oe,r as f,o as s,c as r,a as e,b as n,w as c,t as V,v as q,g as k,y as S,u as b,f as E,F as R,j as B,l as ue}from"./index-4f9ea22f.js";import{_ as ee,u as de,n as re,g as ie,d as ce}from"./InputAddress.vue_vue_type_style_index_0_lang-db453c13.js";import{o as pe,a as me}from"./helpers-a12fb3e4.js";import{l as L}from"./lodash-04ea7520.js";const ve={class:"bg-blue-50"},_e=e("div",{class:"mb-4"},[e("div",{class:"flex justify-between align-center justify-center"},[e("h1",{class:"h5 font-bold m-0"},"Nueva Ruta")])],-1),fe={class:"new-customer gap-8"},be={class:"w-full bg-white p-2 mt-3 mb-4 py-5"},ye={class:"gap-2"},he={key:0,class:"text-xs font-bold uppercase"},xe={class:"bg-white columns-2 py-1 pb-3"},ge={class:"columns-4 mb-4"},Ve=e("span",{class:"px-0 -mx-1 font-bold text-sm"},"S/",-1),ke=e("div",null,[e("br")],-1),Ce=e("hr",null,null,-1),$e={class:"columns-3 mt-4 gap-0"},we={class:"bg-gray-100 py-1"},je={class:"font-bold text-black text-sm text-center"},qe=e("span",{class:"uppercase text-xs"},"(Ida)",-1),Ue={class:"bg-blue-100 py-1"},Ne={class:"font-bold text-black text-sm text-center"},Se=e("span",{class:"uppercase text-xs"},"(Vuelta)",-1),Ee={class:"bg-gray-100 py-1"},Re={class:"font-bold text-black text-sm text-center"},Be={class:"flex gap-0"},Te={class:"flex flex-col w-1/3"},Ie={class:"flex gap-1 toll"},De={class:"flex flex-col w-1/3"},Fe={class:"flex gap-1 toll"},Le={class:"flex flex-col w-1/3"},Pe={class:"flex gap-1 toll"},Me={class:"flex justify-end"},Oe={class:"flex gap-2"},ze=e("span",{class:"text-xs px-1"},"Guardar",-1),Ae=le({__name:"NewRoute",props:{data:{default:null,type:Object}},emits:["close"],setup(J,{emit:P}){const i=J,U=pe,C=me,M=P,$=m(!1),y=m([]),h=m([]),g=m([]),{isValid:T,validate:O,reset:D}=se("formRef"),u=ne({}),N=m(null),v=m(null);oe(()=>{var o,l,x;i.data&&(u.baseprice=((o=i.data)==null?void 0:o.baseprice)||0,u.kilometers=((l=i.data)==null?void 0:l.kilometers)||0,u.hours=((x=i.data)==null?void 0:x.travelhours)||0,y.value=i.data.tolls.filter(d=>d.type==0).map(d=>({q:d.vehicle_type,amount:d.amount})),h.value=i.data.tolls.filter(d=>d.type==2).map(d=>({q:d.vehicle_type,amount:d.amount})),g.value=i.data.tolls.filter(d=>d.type==1).map(d=>({q:d.vehicle_type,amount:d.amount})))});const _=async()=>{var o;if(O()){$.value=!0;try{(o=i.data)!=null&&o.id?await de({kilometers:u.kilometers||0,baseprice:u.baseprice||0,travelhours:u.hours||0,tolls:{from:y.value.filter(l=>l.amount!==0).map(l=>({vehicle_type:l.q,amount:l.amount})),adtionals:h.value.filter(l=>l.amount!==0).map(l=>({vehicle_type:l.q,amount:l.amount})),to:g.value.filter(l=>l.amount!==0).map(l=>({vehicle_type:l.q,amount:l.amount}))}},i.data.id):await re({from:N.value.label,to:v.value.label,kilometers:u.kilometers||0,baseprice:u.baseprice||0,travelhours:u.hours||0,tolls:{from:y.value.filter(l=>l.amount!==0).map(l=>({vehicle_type:l.q,amount:l.amount})),adtionals:h.value.filter(l=>l.amount!==0).map(l=>({vehicle_type:l.q,amount:l.amount})),to:g.value.filter(l=>l.amount!==0).map(l=>({vehicle_type:l.q,amount:l.amount}))}}),D(),M("close")}catch(l){console.log(l)}$.value=!1}},w=()=>{y.value.push({q:j[0],amount:0})},z=()=>{g.value.push({q:j[0],amount:0})},F=()=>{h.value.push({q:a[0],amount:0})},A=o=>{y.value.splice(o,1)},G=o=>{h.value.splice(o,1)},H=o=>{g.value.splice(o,1)},j=["Ligero","2 Ejes","3 Ejes","4 Ejes","5 Ejes","6 Ejes","7 Ejes","8 Ejes","9 Ejes","10 Ejes","11 Ejes","12 Ejes","13 Ejes","14 Ejes","15 Ejes"],a=["Aeropuerto"];return(o,l)=>{var Q,W,X;const x=f("VaInput"),d=f("VaIcon"),K=f("VaSelect"),te=f("VaForm"),ae=f("VaButton");return s(),r("div",ve,[_e,e("div",fe,[n(te,{ref:"formRef",immediate:"",class:"gap-2"},{default:c(()=>{var Y,Z;return[e("div",be,[e("div",ye,[o.$props.data?(s(),r("p",he,V((Y=o.$props.data)==null?void 0:Y.from)+" / "+V((Z=o.$props.data)==null?void 0:Z.to),1)):q("",!0),e("div",xe,[e("div",null,[o.$props.data?q("",!0):(s(),k(ee,{key:0,label:"Origen",onlyaddress:!0,nomaps:!0,onSelected:l[0]||(l[0]=t=>N.value=t)}))]),e("div",null,[o.$props.data?q("",!0):(s(),k(ee,{key:0,label:"Destino",onlyaddress:!0,nomaps:!0,onSelected:l[1]||(l[1]=t=>v.value=t)}))])]),e("div",ge,[e("div",null,[S((s(),k(x,{modelValue:u.baseprice,"onUpdate:modelValue":l[2]||(l[2]=t=>u.baseprice=t),label:"Precio base de Servicio",min:"0",onChange:l[3]||(l[3]=()=>{u.baseprice=b(L.ceil)(u.baseprice,2)})},{prependInner:c(()=>[Ve]),_:1},8,["modelValue"])),[[b(U)]])]),ke,e("div",null,[S(n(x,{modelValue:u.kilometers,"onUpdate:modelValue":l[4]||(l[4]=t=>u.kilometers=t),label:"Kilometros",type:"number",min:"0"},null,8,["modelValue"]),[[b(C)]])]),e("div",null,[S(n(x,{modelValue:u.hours,"onUpdate:modelValue":l[5]||(l[5]=t=>u.hours=t),label:"Horas de Viaje",type:"number",min:".5"},null,8,["modelValue"]),[[b(C)]])])]),Ce,e("div",$e,[e("div",we,[e("p",je,[E(" Peajes "),qe,n(d,{color:"primary",name:"add_circle",class:"cursor-pointer ml-2",onClick:l[6]||(l[6]=t=>w())})])]),e("div",Ue,[e("p",Ne,[E(" Peajes "),Se,n(d,{color:"primary",name:"add_circle",class:"cursor-pointer ml-2",onClick:l[7]||(l[7]=t=>z())})])]),e("div",Ee,[e("p",Re,[E(" Adicionales "),n(d,{color:"primary",name:"add_circle",class:"cursor-pointer ml-2",onClick:l[8]||(l[8]=t=>F())})])])]),e("div",Be,[e("div",Te,[(s(!0),r(R,null,B(y.value,(t,I)=>(s(),r("div",{key:t,class:"bg-gray-100 px-1 pb-1"},[e("div",Ie,[n(K,{modelValue:t.q,"onUpdate:modelValue":p=>t.q=p,class:"quantity text-xxs",options:j,placeholder:"Selecciona un tipo",background:"#fff"},null,8,["modelValue","onUpdate:modelValue"]),S((s(),k(x,{modelValue:t.amount,"onUpdate:modelValue":p=>t.amount=p,type:"text",class:"amount",background:"#fff",onChange:()=>{t.amount=b(L.ceil)(t.amount,2)}},{append:c(()=>[n(d,{name:"delete",class:"cursor-pointer ml-1 relative -left-0.5 mr-1",color:"danger",onClick:p=>A(I)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])),[[b(U)]])])]))),128))]),e("div",De,[(s(!0),r(R,null,B(g.value,(t,I)=>(s(),r("div",{key:t,class:"flex flex-col bg-blue-100 pl-1 pr-3 pb-1"},[e("div",Fe,[n(K,{modelValue:t.q,"onUpdate:modelValue":p=>t.q=p,class:"quantity text-xxs",options:j,placeholder:"Selecciona un tipo",background:"#fff"},null,8,["modelValue","onUpdate:modelValue"]),S((s(),k(x,{modelValue:t.amount,"onUpdate:modelValue":p=>t.amount=p,type:"text",class:"amount",background:"#fff",onChange:()=>{t.amount=b(L.ceil)(t.amount,2)}},{append:c(()=>[n(d,{name:"delete",class:"cursor-pointer ml-1 relative -left-0.5 mr-1",color:"danger",onClick:p=>H(I)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])),[[b(U)]])])]))),128))]),e("div",Le,[(s(!0),r(R,null,B(h.value,(t,I)=>(s(),r("div",{key:t,class:"bg-gray-100 px-1 pb-1"},[e("div",Pe,[n(K,{modelValue:t.q,"onUpdate:modelValue":p=>t.q=p,class:"quantity text-xxs min-w-[110px]",options:a,placeholder:"Selecciona un tipo",background:"#fff"},null,8,["modelValue","onUpdate:modelValue"]),S((s(),k(x,{modelValue:t.amount,"onUpdate:modelValue":p=>t.amount=p,type:"text",class:"amount max-w-[100px]",background:"#fff",onChange:()=>{t.amount=b(L.ceil)(t.amount,2)}},{append:c(()=>[n(d,{name:"delete",class:"cursor-pointer ml-1 relative -left-0.5 mr-1",color:"danger",onClick:p=>G(I)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])),[[b(U)]])])]))),128))])])])])]}),_:1},512)]),e("div",null,[e("div",Me,[e("div",Oe,[n(ae,{icon:"save",color:"primary",disabled:!b(T)||!((Q=o.$props.data)!=null&&Q.id)&&(!((W=N.value)!=null&&W.label)||!((X=v.value)!=null&&X.label)),loading:$.value,onClick:_},{default:c(()=>[ze]),_:1},8,["disabled","loading"])])])])])}}});const Ge={class:"flex flex-col space-y-6 md:space-y-4"},He=e("span",{class:"px-1"},"Nueva Ruta",-1),Ke={class:"flex flex-col p-4 bg-backgroundSecondary rounded-lg"},Je={class:"va-table-responsive"},Qe={class:"va-table w-full text-xs"},We=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Origen"),e("th",null,"Destino"),e("th",null,"Kilometros"),e("th",null,"P. Base"),e("th",null,"Horas"),e("th",null,"Peajes"),e("th")])],-1),Xe={key:0,class:"m-0 font-bold text-xs"},Ye={key:1,class:"bg-blue-100 px-2 pb-2 pt-1 rounded-md"},Ze={key:0},el=e("p",{class:"text-xs font-bold mb-1 px-1"},"Ida:",-1),ll={key:1},ol=e("p",{class:"text-xs font-bold mt-2 mb-1 px-1"},"Vuelta:",-1),tl={class:"flex gap-1"},al=e("p",{class:"text-sm"},"¿Deseas continuar?",-1),rl=le({__name:"General",setup(J){const{notify:P}=ue(),i=m(!1),U=m(!1),C=m(!1),M=m(!1),$=m(!1),y=m(null),h=m([]),g=()=>{i.value=!1,U.value=!1,T()};oe(()=>{T()});const T=async()=>{$.value=!0;const v=await ie();h.value=v,$.value=!1},O=async()=>{C.value=!1,await ce(y.value),P({message:"Ruta eliminada correctamente",color:"success"}),T()},D=v=>{y.value=v,C.value=!!v},u=m(null),N=v=>{v?(u.value=v,i.value=!0):(u.value=v,i.value=!1)};return(v,_)=>{const w=f("VaButton"),z=f("VaCardTitle"),F=f("VaBadge"),A=f("VaCardContent"),G=f("VaCard"),H=f("VaInnerLoading"),j=f("VaModal");return s(),r("div",Ge,[n(H,{loading:$.value},{default:c(()=>[n(G,null,{default:c(()=>[n(z,{class:"d-flex justify-between"},{default:c(()=>[E(" Maestro de Rutas "),n(w,{icon:"add",color:"primary",onClick:_[0]||(_[0]=a=>i.value=!0)},{default:c(()=>[He]),_:1})]),_:1}),n(A,null,{default:c(()=>[e("div",Ke,[e("div",Je,[e("table",Qe,[We,e("tbody",null,[(s(!0),r(R,null,B(h.value,a=>(s(),r("tr",{key:a.id},[e("td",null,V(a.id),1),e("td",null,V(a.from),1),e("td",null,V(a.to),1),e("td",null,V(a.kilometers||"-"),1),e("td",null,"S/ "+V(a.baseprice),1),e("td",null,V(a.travelhours||"-"),1),e("td",null,[a.tolls.length?q("",!0):(s(),r("p",Xe,"Sin Información")),a.tolls.length?(s(),r("div",Ye,[a.tolls.filter(o=>o.type===0).length?(s(),r("div",Ze,[el,(s(!0),r(R,null,B(a.tolls.filter(o=>o.type===0),o=>(s(),k(F,{key:o,text:"("+o.vehicle_type+") S/"+o.amount,color:"primary",class:"mr-2"},null,8,["text"]))),128))])):q("",!0),a.tolls.filter(o=>o.type===1).length?(s(),r("div",ll,[ol,(s(!0),r(R,null,B(a.tolls.filter(o=>o.type===1),o=>(s(),k(F,{key:o,text:"("+o.vehicle_type+") S/"+o.amount,color:"primary",class:"mr-2"},null,8,["text"]))),128))])):q("",!0)])):q("",!0)]),e("td",null,[e("div",tl,[n(w,{icon:"edit",color:"primary",round:"",onClick:o=>N(a)},null,8,["onClick"]),n(w,{icon:"delete",color:"danger",round:"",onClick:o=>D(a.id)},null,8,["onClick"])])])]))),128))])])])])]),_:1})]),_:1})]),_:1},8,["loading"]),n(j,{modelValue:i.value,"onUpdate:modelValue":_[1]||(_[1]=a=>i.value=a),size:"700px","close-button":"","hide-default-actions":"","no-dismiss":"",blur:"",onClose:_[2]||(_[2]=a=>N(null))},{default:c(()=>[e("div",null,[n(Ae,{data:u.value,onClose:g},null,8,["data"])])]),_:1},8,["modelValue"]),n(j,{modelValue:C.value,"onUpdate:modelValue":_[4]||(_[4]=a=>C.value=a),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:c(()=>[n(w,{size:"small",preset:"secondary",class:"mr-1",onClick:_[3]||(_[3]=a=>D(null))},{default:c(()=>[E(" Cancelar")]),_:1}),n(w,{size:"small",loading:M.value,onClick:O},{default:c(()=>[E(" Continuar")]),_:1},8,["loading"])]),default:c(()=>[al]),_:1},8,["modelValue"])])}}});export{rl as _};
//# sourceMappingURL=General.vue_vue_type_script_setup_true_lang-752e7cc7.js.map
