import{d as Z,u as ee,i as n,y as se,k as le,r as m,o as d,c as r,a as e,t as c,b as t,w as a,m as S,h as _,H as te,f as p,F as j,n as F,_ as oe}from"./index-b45d4e71.js";import{b as ne,N as P,E as ae,c as ie}from"./EditCustomer-5d66d746.js";import{f as ce}from"./format-8e15a9c0.js";import"./utils-17deefef.js";import"./helpers-a12fb3e4.js";const ue={class:"py-4"},de={class:"flex justify-between align-center justify-center"},re={class:"h5 m-0"},pe={class:"flex gap-2"},me=e("span",{class:"px-1"},"Descargar",-1),_e={class:"px-1"},ve={class:"mt-5"},fe={class:"columns-5 mb-7"},he={class:"w-full bg-white p-2"},be={class:"flex gap-1"},ge={class:"flex px-2 py-3 gap-2 bg-blue-50 mx-10 rounded my-2"},ye={class:"w-full pl-2"},Ce={class:"gap-1"},Ve={class:"text-base font-medium"},xe={class:"uppercase font-black"},ke={class:"w-full columns-6 mt-2 mb-1"},Te={key:0,class:"w-full items-center text-xs"},we=e("b",null,"RUC:",-1),ze=e("br",null,null,-1),Ue={key:1,class:"w-full items-center text-xs"},Ne=e("b",null,"Teléfono:",-1),Ae=e("br",null,null,-1),Ie={key:2,class:"w-full items-center text-xs"},Le=e("b",null,"WhatsApp:",-1),Me=e("br",null,null,-1),Re={key:3,class:"w-full items-center text-xs"},Be=e("b",null,"Dirección:",-1),Ee=e("br",null,null,-1),Se={class:"flex flex-col bg-white mt-6 py-2 pb-5 px-4"},je={key:0,class:"bg-gray-100 p-3 rounded mt-4 pb-5"},Fe={key:0,class:"bg-red-300 font-bold p-2"},Pe={key:1,class:"va-table-responsive w-full"},$e={class:"va-table w-full"},We=e("thead",null,[e("tr",null,[e("th",null,"Nombres Completos"),e("th",null,"Documento"),e("th",null,"Teléfono"),e("th",null,"Correo")])],-1),De=["onClick"],He={colspan:"7"},qe={class:"flex justify-end mt-4"},Ke={class:"mt-4"},Oe=e("p",{class:"text-sm"},"¿Deseas eliminar esta empresa?",-1),Ge=Z({__name:"ListCompanies",setup(Je){const{notify:B}=ee(),v=n([]),b=n(!1),f=n(null),g=n(!1),T=n(null),w=n(null),z=n(!1),U=n(!1),y=n(!1),$=n(0),C=n(12),N=n(1),A=n(""),{t:W}=se(),D=[{key:"id",sortable:!1},{key:"Razón Social",sortable:!1},{key:"RUC",sortable:!1},{key:"Teléfono",sortable:!1},{key:"Whatsapp",sortable:!1},{key:"Fecha Creación",sortable:!1},{key:"Acciones",width:80,sortable:!1}],I=n({status:1});le(()=>{L(I.value)});const L=async i=>{U.value=!0;const l=await ne(i);v.value=l.map(o=>({...o,"Razón Social":o.socialreason,RUC:o.ruc,Teléfono:o.phone,Whatsapp:o.whatsapp,"Fecha Creación":o.created_at&&ce(o.created_at,"dd/MM/yyyy hh:mm aa"),Acciones:!0,activeTab:0})),U.value=!1},H=i=>{f.value=i},M=i=>{var l;i?(l=i.contacts)!=null&&l.length?B({message:"No puedes eliminar una empresa con contactos activos.",color:"error",duration:3e3}):(g.value=!!(i!=null&&i.id),T.value=i==null?void 0:i.id):(g.value=!1,T.value=null)},E=()=>{b.value=!1,f.value=!1,L(I.value)},q=async()=>{z.value=!0,await ie(T.value),B({message:"Empresa eliminada correctamente",color:"success",duration:1e3}),setTimeout(()=>{z.value=!1,M(null),L(I.value)})},K=()=>C.value&&C.value!==0?Math.ceil(v.value.length/C.value):v.value.length,R=n(!1),O=()=>{R.value=!0,setTimeout(()=>{R.value=!1},2e3),console.log("download")};return(i,l)=>{const o=m("VaButton"),G=m("VaInput"),V=m("VaIcon"),J=m("VaTab"),Q=m("VaTabs"),X=m("VaPagination"),Y=m("VaDataTable");m("VaChip"),m("VaAlert");const x=m("VaModal");return d(),r("div",ue,[e("div",de,[e("h1",re,"Listado de Empresas ("+c(v.value.length)+")",1),e("div",pe,[t(o,{icon:"exit_to_app",color:"info",loading:R.value,href:S(te)+"/companies/xls",onClick:O},{default:a(()=>[me]),_:1},8,["loading","href"]),t(o,{icon:"domain_add",color:"primary",onClick:l[0]||(l[0]=s=>b.value=!0)},{default:a(()=>[e("span",_e,c(S(W)("contacts.newCompany")),1)]),_:1})])]),e("div",ve,[e("div",fe,[e("div",null,[t(G,{modelValue:A.value,"onUpdate:modelValue":l[1]||(l[1]=s=>A.value=s),label:"Buscar empresa",placeholder:"Escribe lo que buscas",clearable:"",background:"#fff"},null,8,["modelValue"])])]),e("div",he,[t(Y,{items:v.value,columns:D,class:"text-xs",hoverable:"","selected-color":"#eee",filter:A.value,"per-page":C.value,"current-page":N.value,loading:U.value,"no-data-html":"...",onFiltered:l[3]||(l[3]=s=>$.value=s.items.length)},{"cell(Acciones)":a(({row:s,isExpanded:k})=>[e("div",be,[t(o,{icon:"delete",color:"danger",disabled:s.itemKey.contacts.length,round:"",onClick:h=>M(s==null?void 0:s.rowData)},null,8,["disabled","onClick"]),t(o,{icon:"edit",color:"#158de3",round:"",onClick:h=>H(s==null?void 0:s.rowData)},null,8,["onClick"]),t(o,{icon:k?"va-arrow-up":"va-arrow-down",preset:"primary",onClick:h=>s.toggleRowDetails()},null,8,["icon","onClick"])])]),expandableRow:a(({rowData:s})=>{var k,h;return[e("div",ge,[e("div",ye,[e("div",Ce,[e("span",Ve,[e("span",xe,c(s.socialreason),1)])]),e("div",ke,[s.ruc?(d(),r("div",Te,[we,p(),ze,e("span",null,[p(c(s.ruc)+" ",1),t(V,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):_("v-if",!0),s.phone?(d(),r("div",Ue,[Ne,p(),Ae,e("span",null,[p(c(s.phone)+" ",1),t(V,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):_("v-if",!0),s.whatsapp?(d(),r("div",Ie,[Le,p(),Me,e("span",null,[p(c(s.whatsapp)+" ",1),t(V,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):_("v-if",!0),s.address?(d(),r("div",Re,[Be,p(),Ee,e("span",null,[p(c(s.address)+" ",1),t(V,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):_("v-if",!0)]),e("div",Se,[t(Q,{modelValue:s.activeTab,"onUpdate:modelValue":u=>s.activeTab=u},{tabs:a(()=>[(d(),r(j,null,F(["Contactos"],u=>t(J,{key:u},{default:a(()=>[p(c(u),1)]),_:2},1024)),64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),s.activeTab===0?(d(),r("div",je,[(k=s.contacts)!=null&&k.length?_("v-if",!0):(d(),r("p",Fe," La empresa no tiene contactos registrados ")),(h=s.contacts)!=null&&h.length?(d(),r("div",Pe,[e("table",$e,[We,e("tbody",null,[(d(!0),r(j,null,F(s.contacts,u=>(d(),r("tr",{key:u.id},[e("td",null,[e("span",{class:"text-primary font-bold uppercase cursor-pointer hover:underline",onClick:()=>{w.value=u.id,y.value=!0}},c(u.fullname),9,De)]),e("td",null,c(u.document),1),e("td",null,c(u.cellphone),1),e("td",null,c(u.email),1)]))),128))])])])):_("v-if",!0)])):_("v-if",!0)])])])]}),bodyAppend:a(()=>[e("tr",null,[e("td",He,[e("div",qe,[t(X,{modelValue:N.value,"onUpdate:modelValue":l[2]||(l[2]=s=>N.value=s),size:"small",class:"text-xs mb-3 justify-center sm:justify-start","buttons-preset":"primary","active-page-color":"textPrimary",pages:K()},null,8,["modelValue","pages"])])])])]),_:1},8,["items","filter","per-page","current-page","loading","no-data-html"]),_("v-if",!0)])]),t(x,{modelValue:b.value,"onUpdate:modelValue":l[4]||(l[4]=s=>b.value=s),"hide-default-actions":"",size:"340px","close-button":"",blur:"","no-dismiss":""},{default:a(()=>[e("div",null,[t(P,{onClose:E})])]),_:1},8,["modelValue"]),t(x,{modelValue:f.value,"onUpdate:modelValue":l[5]||(l[5]=s=>f.value=s),"hide-default-actions":"",size:"340px","close-button":"",blur:"","no-dismiss":""},{default:a(()=>[e("div",null,[t(P,{data:f.value,onClose:E},null,8,["data"])])]),_:1},8,["modelValue"]),t(x,{modelValue:y.value,"onUpdate:modelValue":l[7]||(l[7]=s=>y.value=s),"hide-default-actions":"",size:"medium","close-button":"",blur:"","no-dismiss":""},{default:a(()=>[e("div",Ke,[t(ae,{id:w.value,onClose:l[6]||(l[6]=()=>{w.value=null,y.value=!1})},null,8,["id"])])]),_:1},8,["modelValue"]),t(x,{modelValue:g.value,"onUpdate:modelValue":l[9]||(l[9]=s=>g.value=s),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:a(()=>[t(o,{size:"small",preset:"secondary",class:"mr-1",onClick:l[8]||(l[8]=s=>M(null))},{default:a(()=>[p(" Cancelar")]),_:1}),t(o,{size:"small",loading:z.value,onClick:q},{default:a(()=>[p(" Continuar")]),_:1},8,["loading"])]),default:a(()=>[Oe]),_:1},8,["modelValue"])])}}}),ss=oe(Ge,[["__file","C:/Users/ID-04/Documents/Main/vuestic-impala/src/pages/customers/pages/ListCompanies.vue"]]);export{ss as default};
//# sourceMappingURL=ListCompanies-cc0d8607.js.map
