import{d as le,l as se,p as u,E as te,s as oe,r as _,o as a,c,a as e,t as n,b as t,w as d,u as P,v as p,H as ne,f as m,F as j,j as B}from"./index-4f9ea22f.js";import{c as ae,_ as q,a as ce,e as ie}from"./EditCustomer.vue_vue_type_style_index_0_lang-35bbd804.js";import{f as ue}from"./format-8e15a9c0.js";import"./utils-17deefef.js";import"./helpers-a12fb3e4.js";const de={class:"py-4"},re={class:"flex flex-wrap sm:flex-nowrap justify-between align-center justify-center"},pe={class:"h5 m-0 mb-3 sm:mb-0"},me={class:"flex flex-wrap sm:flex-nowrap gap-2"},_e=e("span",{class:"px-1"},"Descargar",-1),fe={class:"px-1"},ve={class:"mt-5"},he={class:"columns-1 sm:columns-5 mb-7"},be={class:"w-full bg-white p-2"},ge={class:"flex gap-1"},ye={class:"flex px-2 py-3 gap-2 bg-blue-50 mx-10 rounded my-2"},Ve={class:"w-full pl-2"},xe={class:"gap-1"},Ce={class:"text-base font-medium"},ke={class:"uppercase font-black"},Te={class:"w-full columns-6 mt-2 mb-1"},we={key:0,class:"w-full items-center text-xs"},ze=e("b",null,"RUC:",-1),Ne=e("br",null,null,-1),Ue={key:1,class:"w-full items-center text-xs"},Ae=e("b",null,"Teléfono:",-1),Ee=e("br",null,null,-1),Re={key:2,class:"w-full items-center text-xs"},Se=e("b",null,"WhatsApp:",-1),$e=e("br",null,null,-1),je={key:3,class:"w-full items-center text-xs"},Be=e("b",null,"Dirección:",-1),Fe=e("br",null,null,-1),Ie={class:"flex flex-col bg-white mt-6 py-2 pb-5 px-4"},Me={key:0,class:"bg-gray-100 p-3 rounded mt-4 pb-5"},Le={key:0,class:"bg-red-300 font-bold p-2 -mb-1"},Pe={key:1,class:"va-table-responsive w-full"},qe={class:"va-table w-full"},We=e("thead",null,[e("tr",null,[e("th",null,"n° Cotización"),e("th",null,"Comercial"),e("th",null,"Servicios"),e("th",null,"Vehiculos"),e("th",null,"Fecha Creación"),e("th",null,"Estado")])],-1),He={key:1,class:"bg-gray-100 p-3 rounded mt-4 pb-5"},Ke={key:0,class:"bg-red-300 font-bold p-2"},Oe={key:1,class:"va-table-responsive w-full"},Ge={class:"va-table w-full"},Je=e("thead",null,[e("tr",null,[e("th",null,"Nombres Completos"),e("th",null,"Documento"),e("th",null,"Teléfono"),e("th",null,"Correo")])],-1),Qe=["onClick"],Xe={colspan:"7"},Ye={class:"flex justify-end mt-4"},Ze={class:"mt-4"},De=e("p",{class:"text-sm"},"¿Deseas eliminar esta empresa?",-1),al=le({__name:"ListCompanies",setup(el){const{notify:F}=se(),f=u([]),b=u(!1),v=u(null),g=u(!1),T=u(null),w=u(null),z=u(!1),N=u(!1),y=u(!1),W=u(0),V=u(12),U=u(1),A=u(""),{t:H}=te(),K=[{key:"id",sortable:!1},{key:"Razón Social",sortable:!1},{key:"RUC",sortable:!1},{key:"Teléfono",sortable:!1},{key:"Whatsapp",sortable:!1},{key:"Fecha Creación",sortable:!1},{key:"Acciones",width:80,sortable:!1}],E=u({status:1});oe(()=>{R(E.value)});const R=async r=>{N.value=!0;const s=await ae(r);f.value=s.map(i=>({...i,"Razón Social":i.socialreason,RUC:i.ruc,Teléfono:i.phone,Whatsapp:i.whatsapp,"Fecha Creación":i.created_at&&ue(i.created_at,"dd/MM/yyyy hh:mm aa"),Acciones:!0,activeTab:0})),N.value=!1},O=r=>{v.value=r},S=r=>{var s;r?(s=r.contacts)!=null&&s.length?F({message:"No puedes eliminar una empresa con contactos activos.",color:"error",duration:3e3}):(g.value=!!(r!=null&&r.id),T.value=r==null?void 0:r.id):(g.value=!1,T.value=null)},I=()=>{b.value=!1,v.value=!1,R(E.value)},G=async()=>{z.value=!0,await ie(T.value),F({message:"Empresa eliminada correctamente",color:"success",duration:1e3}),setTimeout(()=>{z.value=!1,S(null),R(E.value)})},J=()=>V.value&&V.value!==0?Math.ceil(f.value.length/V.value):f.value.length,$=u(!1),Q=()=>{$.value=!0,setTimeout(()=>{$.value=!1},2e3),console.log("download")};return(r,s)=>{const i=_("VaButton"),X=_("VaInput"),x=_("VaIcon"),Y=_("VaTab"),Z=_("VaTabs"),D=_("VaPagination"),ee=_("VaDataTable");_("VaChip"),_("VaAlert");const C=_("VaModal");return a(),c("div",de,[e("div",re,[e("h1",pe,"Listado de Empresas ("+n(f.value.length)+")",1),e("div",me,[t(i,{icon:"exit_to_app",color:"info",loading:$.value,href:P(ne)+"/companies/xls",onClick:Q},{default:d(()=>[_e]),_:1},8,["loading","href"]),t(i,{icon:"domain_add",color:"primary",onClick:s[0]||(s[0]=l=>b.value=!0)},{default:d(()=>[e("span",fe,n(P(H)("contacts.newCompany")),1)]),_:1})])]),e("div",ve,[e("div",he,[e("div",null,[t(X,{modelValue:A.value,"onUpdate:modelValue":s[1]||(s[1]=l=>A.value=l),label:"Buscar empresa",placeholder:"Escribe lo que buscas",clearable:"",background:"#fff"},null,8,["modelValue"])])]),e("div",be,[t(ee,{items:f.value,columns:K,class:"text-xs",hoverable:"","selected-color":"#eee",filter:A.value,"per-page":V.value,"current-page":U.value,loading:N.value,"no-data-html":"...",onFiltered:s[3]||(s[3]=l=>W.value=l.items.length)},{"cell(Acciones)":d(({row:l,isExpanded:k})=>[e("div",ge,[t(i,{icon:"delete",color:"danger",disabled:l.itemKey.contacts.length,round:"",onClick:h=>S(l==null?void 0:l.rowData)},null,8,["disabled","onClick"]),t(i,{icon:"edit",color:"#158de3",round:"",onClick:h=>O(l==null?void 0:l.rowData)},null,8,["onClick"]),t(i,{icon:k?"va-arrow-up":"va-arrow-down",preset:"primary",onClick:h=>l.toggleRowDetails()},null,8,["icon","onClick"])])]),expandableRow:d(({rowData:l})=>{var k,h,M,L;return[e("div",ye,[e("div",Ve,[e("div",xe,[e("span",Ce,[e("span",ke,n(l.socialreason),1)])]),e("div",Te,[l.ruc?(a(),c("div",we,[ze,m(),Ne,e("span",null,[m(n(l.ruc)+" ",1),t(x,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):p("",!0),l.phone?(a(),c("div",Ue,[Ae,m(),Ee,e("span",null,[m(n(l.phone)+" ",1),t(x,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):p("",!0),l.whatsapp?(a(),c("div",Re,[Se,m(),$e,e("span",null,[m(n(l.whatsapp)+" ",1),t(x,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):p("",!0),l.address?(a(),c("div",je,[Be,m(),Fe,e("span",null,[m(n(l.address)+" ",1),t(x,{size:"10px",class:"cursor-pointer",name:"content_copy"})])])):p("",!0)]),e("div",Ie,[t(Z,{modelValue:l.activeTab,"onUpdate:modelValue":o=>l.activeTab=o},{tabs:d(()=>[(a(),c(j,null,B(["Contactos","Cotizaciones"],o=>t(Y,{key:o},{default:d(()=>[m(n(o),1)]),_:2},1024)),64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),l.activeTab===1?(a(),c("div",Me,[(k=l.quotations)!=null&&k.length?p("",!0):(a(),c("p",Le," El cliente no tiene cotizaciones ")),(h=l.quotations)!=null&&h.length?(a(),c("div",Pe,[e("table",qe,[We,e("tbody",null,[(a(!0),c(j,null,B(l.quotations,o=>(a(),c("tr",{key:o.id},[e("td",null,n(o.fullName),1),e("td",null,n(o.fullName),1),e("td",null,n(o.fullName),1),e("td",null,n(o.fullName),1),e("td",null,n(o.fullName),1),e("td",null,n(o.fullName),1)]))),128))])])])):p("",!0)])):p("",!0),l.activeTab===0?(a(),c("div",He,[(M=l.contacts)!=null&&M.length?p("",!0):(a(),c("p",Ke," La empresa no tiene contactos registrados ")),(L=l.contacts)!=null&&L.length?(a(),c("div",Oe,[e("table",Ge,[Je,e("tbody",null,[(a(!0),c(j,null,B(l.contacts,o=>(a(),c("tr",{key:o.id},[e("td",null,[e("span",{class:"text-primary font-bold uppercase cursor-pointer hover:underline",onClick:()=>{w.value=o.id,y.value=!0}},n(o.fullname),9,Qe)]),e("td",null,n(o.document),1),e("td",null,n(o.cellphone),1),e("td",null,n(o.email),1)]))),128))])])])):p("",!0)])):p("",!0)])])])]}),bodyAppend:d(()=>[e("tr",null,[e("td",Xe,[e("div",Ye,[t(D,{modelValue:U.value,"onUpdate:modelValue":s[2]||(s[2]=l=>U.value=l),size:"small",class:"text-xs mb-3 justify-center sm:justify-start","buttons-preset":"primary","active-page-color":"textPrimary",pages:J()},null,8,["modelValue","pages"])])])])]),_:1},8,["items","filter","per-page","current-page","loading","no-data-html"]),p("",!0)])]),t(C,{modelValue:b.value,"onUpdate:modelValue":s[4]||(s[4]=l=>b.value=l),"hide-default-actions":"",size:"340px","close-button":"",blur:"","no-dismiss":""},{default:d(()=>[e("div",null,[t(q,{onClose:I})])]),_:1},8,["modelValue"]),t(C,{modelValue:v.value,"onUpdate:modelValue":s[5]||(s[5]=l=>v.value=l),"hide-default-actions":"",size:"340px","close-button":"",blur:"","no-dismiss":""},{default:d(()=>[e("div",null,[t(q,{data:v.value,onClose:I},null,8,["data"])])]),_:1},8,["modelValue"]),t(C,{modelValue:y.value,"onUpdate:modelValue":s[7]||(s[7]=l=>y.value=l),"hide-default-actions":"",size:"medium","close-button":"",blur:"","no-dismiss":""},{default:d(()=>[e("div",Ze,[t(ce,{id:w.value,onClose:s[6]||(s[6]=()=>{w.value=null,y.value=!1})},null,8,["id"])])]),_:1},8,["modelValue"]),t(C,{modelValue:g.value,"onUpdate:modelValue":s[9]||(s[9]=l=>g.value=l),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:d(()=>[t(i,{size:"small",preset:"secondary",class:"mr-1",onClick:s[8]||(s[8]=l=>S(null))},{default:d(()=>[m(" Cancelar")]),_:1}),t(i,{size:"small",loading:z.value,onClick:G},{default:d(()=>[m(" Continuar")]),_:1},8,["loading"])]),default:d(()=>[De]),_:1},8,["modelValue"])])}}});export{al as default};
//# sourceMappingURL=ListCompanies-dcc218a5.js.map
