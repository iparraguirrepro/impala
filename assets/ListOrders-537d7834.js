import{d as J,u as K,r,x as Q,o as W,b as i,c as m,e as w,h as t,t as d,k as X,f as o,w as s,F as S,l as E,m as F,g as _,D as Y}from"./index-b6bf2d81.js";import{g as Z,d as ee}from"./Orders-dd267587.js";import{f as te}from"./format-8e15a9c0.js";const ae={class:"py-4"},le={class:"flex justify-between align-center justify-center"},se={class:"h5 m-0"},oe={class:"columns-5 mb-7 mt-5"},ne={class:"mt-5"},re={class:"w-full bg-white p-2"},ce={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},ie={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},de={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},ue={class:"text-primary font-bold hover:underline cursor-pointer"},pe={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},me={class:"text-primary font-bold hover:underline cursor-pointer"},fe={class:"flex gap-1"},ve={colspan:"8"},ge={class:"flex justify-end mt-4"},_e=t("p",{class:"text-sm"},"¿Deseas eliminar esta orden?",-1),Ve=J({__name:"ListOrders",setup(be){const{notify:I}=K(),u=r([]),P=r(!1),f=r(null),z=r(null),b=r(!1),h=r(!1),{t:M}=Q(),T=[{key:"Nro Orden",sortable:!1},{key:"Cotización",sortable:!1},{key:"Cliente",sortable:!1},{key:"Contacto",sortable:!1},{key:"Servicio",sortable:!1},{key:"Creación",sortable:!1},{key:"Estado",width:"80"},{key:"actions",width:80}],y=r(""),x=r({start:null,end:null}),j=r(0),v=r(15),V=r(1),N=()=>v.value&&v.value!==0?Math.ceil(u.value.length/v.value):u.value.length,$=()=>{const{start:n,end:a}=x.value;if(n&&a){const l=new Date(n).setHours(0),D=new Date(a).setHours(24);C({start:new Date(l).getTime(),end:new Date(D).getTime()})}};W(()=>{C()});const C=async n=>{h.value=!0;const a=await Z(n);u.value=a.map(l=>(console.log(l),{...l,"Nro Orden":`000${l.id}-24`,Cotización:`00${l.service.quotation}`,Contacto:l.customer.cellphone,Cliente:l.company?l.company.socialreason:l.customer.fullname,Servicio:[{label:l.service.services.service}],Creación:te(new Date(l.created_at),"dd/MM/yyyy hh:mm"),Estado:l.status===1?"En Progreso":"Finalizado",actions:null})),h.value=!1},U=n=>{P.value=!!n,z.value=n},k=n=>{f.value=n,z.value=n},L=async()=>{b.value=!0,I({message:"Orden eliminada correctamente",color:"success",duration:1e3}),await ee(f.value),b.value=!1,k(null),C()};return(n,a)=>{const l=i("VaInput"),D=i("VaDateInput"),B=i("VaChip"),O=i("VaBadge"),q=i("VaSelect"),g=i("VaButton"),A=i("VaPagination"),H=i("VaDataTable"),R=i("VaModal");return m(),w("div",ae,[t("div",le,[t("h1",se,d(X(M)("orders.allOrders"))+" ("+d(u.value.length)+")",1)]),t("div",oe,[t("div",null,[o(l,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e),label:"Buscar en resultados",placeholder:"Escribe lo que buscas",clearable:"",background:"#fff"},null,8,["modelValue"])]),t("div",null,[o(D,{modelValue:x.value,"onUpdate:modelValue":[a[1]||(a[1]=e=>x.value=e),$],label:"Filtrar por fecha",placeholder:"Ingresa una fecha",mode:"range",background:"#fff"},null,8,["modelValue"])])]),t("div",ne,[t("div",re,[o(H,{hoverable:"",items:u.value,columns:T,class:"text-xs","selected-color":"#eee",filter:y.value,"per-page":v.value,"current-page":V.value,loading:h.value,"no-data-html":"...",onFiltered:a[3]||(a[3]=e=>j.value=e.items.length)},{"cell(Vehiculos)":s(({...e})=>[t("div",ce,[(m(!0),w(S,null,E(e==null?void 0:e.source,c=>(m(),F(O,{key:c,overlap:"",color:"primary",text:c.value,placement:"top-end"},{default:s(()=>[o(B,{size:"small",color:"#eff6ff",class:"text-xxs font-bold px-1",style:{"--va-chip-sm-height":"1.25rem"}},{default:s(()=>[_(d(c.label),1)]),_:2},1024)]),_:2},1032,["text"]))),128))])]),"cell(Servicio)":s(({...e})=>[t("div",ie,[(m(!0),w(S,null,E(e==null?void 0:e.source,c=>(m(),F(O,{key:c,overlap:"",color:"primary"},{default:s(()=>[o(B,{size:"small",color:"#eff6ff",class:"text-xxs font-bold px-1",style:{"--va-chip-sm-height":"1.25rem"}},{default:s(()=>[_(d(c.label),1)]),_:2},1024)]),_:2},1024))),128))])]),"cell(Id)":s(({value:e})=>[t("div",de,[t("span",ue,d(e),1)])]),"cell(Cotizacion)":s(({value:e})=>[t("div",pe,[t("span",me,d(e),1)])]),"cell(Estado)":s(({value:e})=>[t("div",null,[o(q,{class:Y(["text-xs",e==="Cancelado"?"bg-red-100":e==="Finalizado"?"bg-green-100":e==="En Progreso"?"bg-blue-100":""]),style:{width:"120px","--va-input-wrapper-border-color":"transparent"},readonly:"","model-value":e},null,8,["class","model-value"])])]),"cell(actions)":s(({row:e})=>{var c;return[t("div",fe,[o(g,{icon:"description",to:"/orders/view/"+((c=e==null?void 0:e.rowData)==null?void 0:c.id),color:"#158de3",round:"",onClick:G=>{var p;return U((p=e==null?void 0:e.rowData)==null?void 0:p.id)}},null,8,["to","onClick"]),o(g,{icon:"delete",color:"danger",round:"",onClick:G=>{var p;return k((p=e==null?void 0:e.rowData)==null?void 0:p.id)}},null,8,["onClick"])])]}),bodyAppend:s(()=>[t("tr",null,[t("td",ve,[t("div",ge,[o(A,{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=e=>V.value=e),size:"small","buttons-preset":"primary","active-page-color":"textPrimary",class:"text-xs mb-3 justify-center sm:justify-start",pages:N()},null,8,["modelValue","pages"])])])])]),_:1},8,["items","filter","per-page","current-page","loading","no-data-html"])])]),o(R,{modelValue:f.value,"onUpdate:modelValue":a[5]||(a[5]=e=>f.value=e),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:s(()=>[o(g,{size:"small",preset:"secondary",class:"mr-1",onClick:a[4]||(a[4]=e=>k(null))},{default:s(()=>[_(" Cancelar")]),_:1}),o(g,{size:"small",loading:b.value,onClick:L},{default:s(()=>[_(" Continuar")]),_:1},8,["loading"])]),default:s(()=>[_e]),_:1},8,["modelValue"])])}}});export{Ve as default};
//# sourceMappingURL=ListOrders-537d7834.js.map
