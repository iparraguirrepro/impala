import{d as W,l as X,G as Y,p as r,E as Z,s as ee,r as i,o as f,c as w,a as t,t as d,u as E,b as o,w as s,f as v,F,j as I,g as P,L as te}from"./index-4f9ea22f.js";import{g as ae,d as se}from"./Orders-2876c941.js";import{u as le}from"./orders-store-6c035b54.js";import{f as oe}from"./format-8e15a9c0.js";const ne={class:"py-4"},re={class:"flex justify-between align-center justify-center"},ce={class:"h5 m-0"},ie={class:"columns-5 mb-7 mt-5"},de={class:"relative"},ue={class:"mt-5"},pe={class:"w-full bg-white p-2"},me={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},fe={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},ve={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},ge={class:"text-primary font-bold hover:underline cursor-pointer"},_e={class:"flex flex-col gap-1",style:{"--va-badge-text-wrapper-border-radius":"50%"}},be={class:"text-primary font-bold hover:underline cursor-pointer"},xe={class:"flex gap-1"},ye={colspan:"8"},he={class:"flex justify-end mt-4"},Ve=t("p",{class:"text-sm"},"¿Deseas eliminar esta orden?",-1),Be=W({__name:"ListOrders",setup(Ce){const{notify:T}=X(),j=le(),{statusOptions:M}=Y(j),u=r([]),N=r(!1),g=r(null),z=r(null),b=r(!1),x=r(!1),{t:$}=Z(),L=[{key:"Nro Orden",sortable:!1},{key:"Cotización",sortable:!1},{key:"Cliente",sortable:!1},{key:"Contacto",sortable:!1},{key:"Servicio",sortable:!1},{key:"Creación",sortable:!1},{key:"Estado",width:"80"},{key:"actions",width:80}],y=r(""),h=r({start:null,end:null}),U=r(0),_=r(15),V=r(1),q=()=>_.value&&_.value!==0?Math.ceil(u.value.length/_.value):u.value.length,A=()=>{const{start:n,end:a}=h.value;if(n&&a){const l=new Date(n).setHours(0),D=new Date(a).setHours(24);C({start:new Date(l).getTime(),end:new Date(D).getTime()})}};ee(()=>{C()});const C=async n=>{x.value=!0;const a=await ae(n);u.value=a.map(l=>(console.log(l),{...l,"Nro Orden":`000${l.id}-24`,Cotización:`00${l.service.quotation}`,Contacto:l.customer.cellphone,Cliente:l.company?l.company.socialreason:l.customer.fullname,Servicio:[{label:l.service.services.service}],Creación:oe(new Date(l.created_at),"dd/MM/yyyy hh:mm"),Estado:l.status===1?"En Progreso":"Finalizado",actions:null})),x.value=!1},H=n=>{N.value=!!n,z.value=n},k=n=>{g.value=n,z.value=n},R=async()=>{b.value=!0,T({message:"Orden eliminada correctamente",color:"success",duration:1e3}),await se(g.value),b.value=!1,k(null),C()};return(n,a)=>{const l=i("VaInput"),D=i("VaDateInput"),B=i("VaSelect"),p=i("VaButton"),O=i("VaChip"),S=i("VaBadge"),G=i("VaPagination"),J=i("VaDataTable"),K=i("VaModal");return f(),w("div",ne,[t("div",re,[t("h1",ce,d(E($)("orders.allOrders"))+" ("+d(u.value.length)+")",1)]),t("div",ie,[t("div",null,[o(l,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e),label:"Buscar en resultados",placeholder:"Escribe lo que buscas",clearable:"",background:"#fff"},null,8,["modelValue"])]),t("div",null,[o(D,{modelValue:h.value,"onUpdate:modelValue":[a[1]||(a[1]=e=>h.value=e),A],label:"Filtrar por fecha",placeholder:"Ingresa una fecha",mode:"range",background:"#fff"},null,8,["modelValue"])]),t("div",de,[o(B,{options:E(M),"value-by":"id","text-by":"label",background:"#fff",placeholder:"---",label:"Filtrar por estado",class:"text-xs",style:{"--va-input--border-color":"transparent",width:"120px"}},null,8,["options"]),o(p,{class:"absolute bottom-0.5 mx-4 text-xs",color:"#158de3"},{default:s(()=>[v("Buscar")]),_:1})])]),t("div",ue,[t("div",pe,[o(J,{hoverable:"",items:u.value,columns:L,class:"text-xs","selected-color":"#eee",filter:y.value,"per-page":_.value,"current-page":V.value,loading:x.value,"no-data-html":"...",onFiltered:a[3]||(a[3]=e=>U.value=e.items.length)},{"cell(Vehiculos)":s(({...e})=>[t("div",me,[(f(!0),w(F,null,I(e==null?void 0:e.source,c=>(f(),P(S,{key:c,overlap:"",color:"primary",text:c.value,placement:"top-end"},{default:s(()=>[o(O,{size:"small",color:"#eff6ff",class:"text-xxs font-bold px-1",style:{"--va-chip-sm-height":"1.25rem"}},{default:s(()=>[v(d(c.label),1)]),_:2},1024)]),_:2},1032,["text"]))),128))])]),"cell(Servicio)":s(({...e})=>[t("div",fe,[(f(!0),w(F,null,I(e==null?void 0:e.source,c=>(f(),P(S,{key:c,overlap:"",color:"primary"},{default:s(()=>[o(O,{size:"small",color:"#eff6ff",class:"text-xxs font-bold px-1",style:{"--va-chip-sm-height":"1.25rem"}},{default:s(()=>[v(d(c.label),1)]),_:2},1024)]),_:2},1024))),128))])]),"cell(Id)":s(({value:e})=>[t("div",ve,[t("span",ge,d(e),1)])]),"cell(Cotizacion)":s(({value:e})=>[t("div",_e,[t("span",be,d(e),1)])]),"cell(Estado)":s(({value:e})=>[t("div",null,[o(B,{class:te(["text-xs",e==="Cancelado"?"bg-red-100":e==="Finalizado"?"bg-green-100":e==="En Progreso"?"bg-blue-100":""]),style:{width:"120px","--va-input-wrapper-border-color":"transparent"},readonly:"","model-value":e},null,8,["class","model-value"])])]),"cell(actions)":s(({row:e})=>{var c;return[t("div",xe,[o(p,{icon:"description",to:"/orders/view/"+((c=e==null?void 0:e.rowData)==null?void 0:c.id),color:"#158de3",round:"",onClick:Q=>{var m;return H((m=e==null?void 0:e.rowData)==null?void 0:m.id)}},null,8,["to","onClick"]),o(p,{icon:"delete",color:"danger",round:"",onClick:Q=>{var m;return k((m=e==null?void 0:e.rowData)==null?void 0:m.id)}},null,8,["onClick"])])]}),bodyAppend:s(()=>[t("tr",null,[t("td",ye,[t("div",he,[o(G,{modelValue:V.value,"onUpdate:modelValue":a[2]||(a[2]=e=>V.value=e),size:"small","buttons-preset":"primary","active-page-color":"textPrimary",class:"text-xs mb-3 justify-center sm:justify-start",pages:q()},null,8,["modelValue","pages"])])])])]),_:1},8,["items","filter","per-page","current-page","loading","no-data-html"])])]),o(K,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=e=>g.value=e),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:s(()=>[o(p,{size:"small",preset:"secondary",class:"mr-1",onClick:a[4]||(a[4]=e=>k(null))},{default:s(()=>[v(" Cancelar")]),_:1}),o(p,{size:"small",loading:b.value,onClick:R},{default:s(()=>[v(" Continuar")]),_:1},8,["loading"])]),default:s(()=>[Ve]),_:1},8,["modelValue"])])}}});export{Be as default};
//# sourceMappingURL=ListOrders-b03fc62c.js.map
