import{d as Ce,u as xe,r as u,a as Y,o as ke,b as v,c as x,e as H,h as n,f as s,w as t,F as he,g as V,k as c,n as z,m as Z,A as me,i as fe}from"./index-5c8bf84e.js";import{g as qe,u as ze,n as Be,d as Ie,a as Me,b as Fe,c as Oe,e as Ge,f as Re,h as He,i as Le,j as Pe,k as Qe,l as Je,m as Ke}from"./Services-5fdaf7dd.js";import{v as y}from"./utils-17deefef.js";import{l as ee}from"./lodash-2dc3c718.js";import{o as De,a as We}from"./helpers-a12fb3e4.js";const Xe={class:"flex flex-col space-y-6 md:space-y-4"},Ye={class:"flex flex-col p-4 bg-backgroundSecondary rounded-lg"},Ze={class:"flex gap-1"},el=n("h4",{class:"text-base mb-4"},"Nuevo Viatico",-1),ll={class:"flex flex-col"},al=n("span",{class:"pr-2 font-bold text-sm"},"S/",-1),sl={class:"flex"},ol=n("span",{class:"ml-2"},"Guardar",-1),tl=n("p",{class:"text-sm"},"¿Deseas continuar?",-1),nl=Ce({__name:"Expenses",setup(M){const p=De,{notify:k}=xe(),$=[{key:"Tipo",sortable:!0},{key:"Valor",sortable:!0},{key:"Acciones",width:80}],L=u([]),P=u(null),T=u(!1),E=u(!1),Q=u(!1),_=u(!1),m=u({}),{validate:N,reset:h}=Y("formExpense");ke(async()=>{await U()});async function U(){_.value=!0;const r=await qe();L.value=r.map(o=>({...o,Tipo:o.name,Valor:`S/ ${o.value||"0.00"}`})),_.value=!1}const D=async()=>{await Ie(P.value),await U(),E.value=!1},b=async r=>{try{N(),_.value=!0,r?await ze(r,{...m.value}):await Be({...m.value}),await U(),_.value=!1,h(),k({message:"Proceso finalizado",color:"success"}),A.value=null,T.value=!1}catch(o){console.log(o)}},j=r=>{E.value=!!r,P.value=r},A=u(null),C=r=>{r?(T.value=r,A.value=r,m.value.name=r.name,m.value.value=r.value):(A.value=r,m.value.name="",m.value.value="")},i=()=>{A.value?b(A.value.id):b()};return(r,o)=>{const w=v("VaButton"),le=v("VaCardTitle"),ae=v("VaDataTable"),se=v("VaCardContent"),oe=v("VaCard"),J=v("VaInput"),F=v("VaForm"),B=v("VaModal");return x(),H(he,null,[n("div",Xe,[s(oe,null,{default:t(()=>[s(le,{class:"flex justify-between"},{default:t(()=>[V(" Viaticos "),s(w,{class:"ml-3 pr-2 pl-1",icon:"add",color:"primary",onClick:o[0]||(o[0]=d=>T.value=!0)},{default:t(()=>[V("Agregar")]),_:1})]),_:1}),s(se,null,{default:t(()=>[n("div",Ye,[s(ae,{items:L.value,columns:$,class:"text-xs",loading:_.value},{"cell(Acciones)":t(({row:d})=>[n("div",Ze,[s(w,{icon:"edit",color:"primary",round:"",onClick:O=>C(d==null?void 0:d.rowData)},null,8,["onClick"]),s(w,{icon:"delete",color:"danger",round:"",onClick:O=>{var I;return j((I=d==null?void 0:d.rowData)==null?void 0:I.id)}},null,8,["onClick"])])]),_:1},8,["items","loading"])])]),_:1})]),_:1}),s(B,{modelValue:T.value,"onUpdate:modelValue":o[4]||(o[4]=d=>T.value=d),"hide-default-actions":"",size:"300px","close-button":"",blur:"","no-dismiss":"",onClose:o[5]||(o[5]=d=>C(null)),onOk:b},{default:t(()=>[n("div",null,[el,n("div",ll,[s(F,{ref:"formExpense",immediate:"",class:"gap-2"},{default:t(()=>[s(J,{modelValue:m.value.name,"onUpdate:modelValue":o[1]||(o[1]=d=>m.value.name=d),stateful:"",name:"name",clearable:"",label:"Tipo de viatico",class:"mb-4",rules:[c(y).required]},null,8,["modelValue","rules"]),z((x(),Z(J,{modelValue:m.value.value,"onUpdate:modelValue":o[2]||(o[2]=d=>m.value.value=d),stateful:"",name:"value",clearable:"",label:"Valor promedio",class:"mb-5",rules:[c(y).required],onChange:o[3]||(o[3]=()=>{m.value.value=c(ee.ceil)(m.value.value,2)})},{prependInner:t(()=>[al]),_:1},8,["modelValue","rules"])),[[c(p)]])]),_:1},512)]),n("div",sl,[s(w,{class:"pr-2 pl-1",icon:"save",color:"primary",loading:_.value,onClick:i},{default:t(()=>[ol]),_:1},8,["loading"])])])]),_:1},8,["modelValue"])]),s(B,{modelValue:E.value,"onUpdate:modelValue":o[7]||(o[7]=d=>E.value=d),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:t(()=>[s(w,{size:"small",preset:"secondary",class:"mr-1",onClick:o[6]||(o[6]=d=>j(null))},{default:t(()=>[V(" Cancelar")]),_:1}),s(w,{size:"small",loading:Q.value,onClick:D},{default:t(()=>[V(" Continuar")]),_:1},8,["loading"])]),default:t(()=>[tl]),_:1},8,["modelValue"])],64)}}}),we={list:me+"/currencies",delete:me+"/currencies",register:me+"/currencies"},Se=localStorage.getItem("__token");async function ul(){const M={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Se}};let p=null;return await fetch(we.list,M).then(k=>{p=k.json()}),p}async function il(M){const p={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Se}};let k=null;return await fetch(`${we.delete}/${M}`,p).then($=>{k=$.json()}),k}const rl={class:"flex flex-col space-y-6 md:space-y-4"},cl={class:"flex flex-col p-4 bg-backgroundSecondary rounded-lg"},dl={class:"flex gap-1"},vl=n("h4",{class:"text-base mb-4"},"Nuevo vehiculo",-1),ml={class:"flex flex-col"},fl=n("span",{class:"font-bold text-sm"},"S/",-1),pl={class:"flex"},Vl=n("span",{class:"ml-2"},"Registrar",-1),yl={class:"flex flex-col p-4 bg-backgroundSecondary rounded-lg"},bl={class:"flex gap-1"},gl=n("h4",{class:"text-base mb-4"},"Nuevo tipo de conductor",-1),_l={class:"flex flex-col"},Cl=n("span",{class:"pr-2 font-bold text-sm"},"S/",-1),xl={class:"flex"},kl=n("span",{class:"ml-2"},"Registrar",-1),hl={class:"flex flex-col p-4 bg-backgroundSecondary rounded-lg"},Dl={class:"flex gap-1"},wl={key:0,class:"text-base mb-4"},Sl={key:1,class:"text-base mb-4"},$l={class:"flex flex-col"},Tl={class:"columns-2"},El=n("span",{class:"pr-2 font-bold text-sm"},"S/",-1),Nl={class:"mb-5"},Ul=n("p",{style:{"font-size":"11px","font-weight":"600",color:"var(--va-primary)"}},"Condiciones especificas:",-1),jl={key:2,class:"flex"},Al=n("span",{class:"ml-2"},"Guardar",-1),ql=n("p",{class:"text-sm"},"¿Deseas continuar?",-1),Ol=Ce({__name:"Masters",setup(M){const p=De,k=We,{notify:$}=xe(),L=[{key:"Vehiculo",sortable:!0},{key:"Tipo",sortable:!0},{key:"Fabricación",sortable:!0},{key:"Capacidad",sortable:!0},{key:"Gal/Hr",sortable:!0},{key:"Maquina Seca",sortable:!0},{key:"Acciones",width:80}],P=[{key:"Tipo Conductor",sortable:!0},{key:"Tarifa",sortable:!0},{key:"Acciones",width:80}],T=[{key:"Servicio",sortable:!0},{key:"Descripción",sortable:!0},{key:"Tarifa base",sortable:!0},{key:"Acciones",width:80}],E=u([]),Q=u([]),_=u([]),m=u([]),N=u(null),h=u(!1),U=u(!1),D=u(!1),b=u(!1),j=u(!1),A=u(!1),C=u(null),i=u({}),r=u({}),o=u({}),{validate:w,reset:le}=Y("fgVehicle"),{validate:ae,reset:se}=Y("fgDriver"),{validate:oe,reset:J}=Y("fgService");ke(()=>{O(),te(),pe(),B()});const F=u(!1);async function B(){F.value=!0;const l=await Me();_.value=l.map(e=>({...e,Servicio:e.service,Descripción:e.description,"Tarifa base":e.fee?`S/ ${e.fee||"0.00"}`:"-"})),F.value=!1}const d=u(!1);async function O(){d.value=!0;const l=await Fe();E.value=l.map(e=>({...e,Vehiculo:e.name,Tipo:e.type,Fabricación:e.year,Capacidad:e.capacity,"Gal/Hr":`${e.cost||0}`,"Maquina Seca":e.fee?`S/ ${e.fee||"0.00"}`:"-"})),d.value=!1}const I=u(!1);async function te(){I.value=!0;const l=await Oe();Q.value=l.map(e=>{if(e.fee>0)return{...e,"Tipo Conductor":e.type,Tarifa:e.fee?`S/ ${e.fee||"0.00"}`:"-"}}).filter(e=>e),I.value=!1}async function pe(){const l=await ul();m.value=l.map(e=>({...e,Moneda:e.label,"Tipo de Cambio":e.value}))}const $e=async()=>{C.value==="vehicles"&&(await Le(N.value),await O()),C.value==="currencies"&&(await il(N.value),await pe()),C.value==="drivers"&&(await Pe(N.value),await te()),C.value==="service"&&(await Qe(N.value),await B()),C.value=null,j.value=!1},Ve=async()=>{U.value=!0;try{w(),await Ge({...i.value}),await O(),$({message:"Vehiculo registrado correctamente",color:"success"}),U.value=!1,le(),h.value=!1}catch(l){console.log(l)}},ne=u(!1),ye=async()=>{var l;try{ae(),ne.value=!0;const e=(l=W.value)==null?void 0:l.id;e?await Re(e,{...r.value}):await He({...r.value}),await te(),$({message:"Conductor registrado correctamente",color:"success"}),ne.value=!1,W.value=null,se(),D.value=!1}catch(e){console.log(e)}},ue=u(!1),Te=async()=>{var l;try{oe(),ue.value=!0,(l=G.value)!=null&&l.id?await Je(G.value.id,{...o.value}):await Ke({...o.value}),await B(),$({message:"Servicio registrado correctamente",color:"success"}),ue.value=!1,J(),o.value={},b.value=!1}catch(e){console.log(e)}},K=(l,e)=>{j.value=!!l,N.value=l,C.value=e},q=u(!1),Ee=()=>{o.value={},q.value=!1,G.value=null},Ne=["Ligero","2 Ejes","3 Ejes","4 Ejes","5 Ejes","6 Ejes","7 Ejes","8 Ejes","9 Ejes","10 Ejes","11 Ejes","12 Ejes","13 Ejes","14 Ejes","15 Ejes"],be=u(null),ge=l=>{l?(be.value=l,h.value=!0,i.value.name=l==null?void 0:l.name,i.value.type=l==null?void 0:l.type,i.value.capacity=l==null?void 0:l.capacity,i.value.year=l==null?void 0:l.year,i.value.fee=l==null?void 0:l.fee,i.value.cost=l==null?void 0:l.cost):(be.value=null,h.value=!1,i.value.name="",i.value.type="",i.value.year="",i.value.capacity="",i.value.fee="",i.value.cost="")},W=u(null),_e=l=>{l?(W.value=l,D.value=!0,r.value.type=l==null?void 0:l.type,r.value.fee=l==null?void 0:l.fee):(W.value=null,D.value=!1,r.value.type="",r.value.fee="")},G=u(null),Ue=l=>{l?(G.value=l,b.value=!0,o.value.specifications=l==null?void 0:l.specifications,o.value.service=l==null?void 0:l.service,o.value.description=l==null?void 0:l.description,o.value.fee=l==null?void 0:l.fee):(G.value=l,b.value=!1,o.value.specifications="",o.value.service="",o.value.description="",o.value.fee="")};return(l,e)=>{const f=v("VaButton"),ie=v("VaCardTitle"),re=v("VaDataTable"),ce=v("VaCardContent"),de=v("VaCard"),g=v("VaInput"),je=v("VaSelect"),ve=v("VaForm"),X=v("VaModal"),Ae=v("QuillEditor");return x(),H(he,null,[n("div",rl,[s(de,null,{default:t(()=>[s(ie,{class:"flex justify-between"},{default:t(()=>[V(" Vehiculos "),s(f,{class:"ml-3 pr-2 pl-1",icon:"add",color:"primary",onClick:e[0]||(e[0]=a=>h.value=!0)},{default:t(()=>[V("Agregar")]),_:1})]),_:1}),s(ce,null,{default:t(()=>[n("div",cl,[s(re,{items:E.value,columns:L,class:"text-xs",loading:d.value},{"cell(Acciones)":t(({row:a})=>[n("div",dl,[s(f,{icon:"edit",color:"primary",round:"",onClick:R=>ge(a==null?void 0:a.rowData)},null,8,["onClick"]),s(f,{icon:"delete",color:"danger",round:"",onClick:R=>{var S;return K((S=a==null?void 0:a.rowData)==null?void 0:S.id,"vehicles")}},null,8,["onClick"])])]),_:1},8,["items","loading"])])]),_:1})]),_:1}),s(X,{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=a=>h.value=a),"hide-default-actions":"",size:"300px","close-button":"",blur:"","no-dismiss":"",onClose:e[9]||(e[9]=a=>ge(null)),onOk:Ve},{default:t(()=>[n("div",null,[vl,n("div",ml,[s(ve,{ref:"fgVehicle",immediate:"",class:"gap-2"},{default:t(()=>[s(g,{modelValue:i.value.name,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value.name=a),stateful:"",name:"name",clearable:"",label:"Nombre de Vehiculo",class:"mb-3",rules:[c(y).required]},null,8,["modelValue","rules"]),s(je,{modelValue:i.value.type,"onUpdate:modelValue":e[2]||(e[2]=a=>i.value.type=a),class:"w-full text-xs mb-3",label:"Tipo de Vehiculo",options:Ne,placeholder:"Selecciona un tipo",rules:[c(y).required]},null,8,["modelValue","rules"]),z(s(g,{modelValue:i.value.capacity,"onUpdate:modelValue":e[3]||(e[3]=a=>i.value.capacity=a),stateful:"",name:"capacity",type:"number",clearable:"",label:"Capacidad",class:"mb-3",rules:[c(y).required]},null,8,["modelValue","rules"]),[[c(p)]]),z(s(g,{modelValue:i.value.year,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value.year=a),stateful:"",name:"year",type:"text",clearable:"",label:"Año",class:"mb-3",rules:[c(y).required]},null,8,["modelValue","rules"]),[[c(k)]]),z((x(),Z(g,{modelValue:i.value.fee,"onUpdate:modelValue":e[5]||(e[5]=a=>i.value.fee=a),stateful:"",name:"fee",clearable:"",label:"Maquina Seca",class:"mb-3",rules:[c(y).required],onChange:e[6]||(e[6]=()=>{i.value.fee=c(ee.ceil)(i.value.fee,2)})},{prependInner:t(()=>[fl]),_:1},8,["modelValue","rules"])),[[c(p)]]),z(s(g,{modelValue:i.value.cost,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value.cost=a),stateful:"",type:"number",name:"cost",clearable:"",label:"Consumo por kilometro (gal/hr)",class:"mb-5"},null,8,["modelValue"]),[[c(p)]])]),_:1},512)]),n("div",pl,[s(f,{class:"pr-2 pl-1",icon:"save",color:"primary",loading:U.value,onClick:Ve},{default:t(()=>[Vl]),_:1},8,["loading"])])])]),_:1},8,["modelValue"]),s(de,null,{default:t(()=>[s(ie,{class:"flex justify-between"},{default:t(()=>[V(" Conductores "),s(f,{class:"ml-3 pr-2 pl-1",icon:"add",color:"primary",onClick:e[10]||(e[10]=a=>D.value=!0)},{default:t(()=>[V("Agregar")]),_:1})]),_:1}),s(ce,null,{default:t(()=>[n("div",yl,[s(re,{items:Q.value,columns:P,class:"text-xs",loading:I.value},{"cell(Acciones)":t(({row:a})=>[n("div",bl,[s(f,{icon:"edit",color:"primary",round:"",onClick:R=>_e(a==null?void 0:a.rowData)},null,8,["onClick"]),s(f,{icon:"delete",color:"danger",round:"",onClick:R=>{var S;return K((S=a==null?void 0:a.rowData)==null?void 0:S.id,"drivers")}},null,8,["onClick"])])]),_:1},8,["items","loading"])])]),_:1})]),_:1}),s(X,{modelValue:D.value,"onUpdate:modelValue":e[14]||(e[14]=a=>D.value=a),"hide-default-actions":"",size:"300px","close-button":"",blur:"","no-dismiss":"",onClose:e[15]||(e[15]=a=>_e(null)),onOk:ye},{default:t(()=>[n("div",null,[gl,n("div",_l,[s(ve,{ref:"fgDriver",immediate:"",class:"gap-2"},{default:t(()=>[s(g,{modelValue:r.value.type,"onUpdate:modelValue":e[11]||(e[11]=a=>r.value.type=a),stateful:"",name:"type",clearable:"",label:"Tipo de chofer",class:"mb-3",rules:[c(y).required]},null,8,["modelValue","rules"]),z((x(),Z(g,{modelValue:r.value.fee,"onUpdate:modelValue":e[12]||(e[12]=a=>r.value.fee=a),stateful:"",name:"fee",clearable:"",label:"Tarifa por Hora",class:"mb-5",rules:[c(y).required],onChange:e[13]||(e[13]=()=>{r.value.fee=c(ee.ceil)(r.value.fee,2)})},{prependInner:t(()=>[Cl]),_:1},8,["modelValue","rules"])),[[c(p)]])]),_:1},512)]),n("div",xl,[s(f,{class:"pr-2 pl-1",icon:"save",color:"primary",loading:ne.value,onClick:ye},{default:t(()=>[kl]),_:1},8,["loading"])])])]),_:1},8,["modelValue"]),s(de,null,{default:t(()=>[s(ie,{class:"flex justify-between"},{default:t(()=>[V(" Servicios "),s(f,{class:"ml-3 pr-2 pl-1",icon:"add",color:"primary",onClick:e[16]||(e[16]=a=>b.value=!0)},{default:t(()=>[V("Agregar")]),_:1})]),_:1}),s(ce,null,{default:t(()=>[n("div",hl,[s(re,{items:_.value,columns:T,class:"text-xs",loading:F.value},{"cell(Acciones)":t(({row:a})=>[n("div",Dl,[s(f,{icon:"edit",color:"primary",round:"",onClick:R=>Ue(a==null?void 0:a.rowData)},null,8,["onClick"]),s(f,{icon:"delete",color:"danger",round:"",onClick:R=>{var S;return K((S=a==null?void 0:a.rowData)==null?void 0:S.id,"service")}},null,8,["onClick"])])]),_:1},8,["items","loading"])])]),_:1})]),_:1}),s(X,{modelValue:b.value,"onUpdate:modelValue":e[22]||(e[22]=a=>b.value=a),"hide-default-actions":"",size:"400px","close-button":"","no-dismiss":"",blur:"",onBeforeClose:Ee},{default:t(()=>[n("div",null,[q.value?fe("",!0):(x(),H("h4",wl,"Nuevo Servicio")),q.value?(x(),H("h4",Sl,"Detalle de Servicio")):fe("",!0),n("div",$l,[s(ve,{ref:"fgService",immediate:"",class:"gap-2"},{default:t(()=>[s(g,{modelValue:o.value.service,"onUpdate:modelValue":e[17]||(e[17]=a=>o.value.service=a),stateful:"",name:"service",clearable:"",label:"Tipo de servicio",class:"mb-3",readonly:q.value,rules:[c(y).required]},null,8,["modelValue","readonly","rules"]),n("div",Tl,[n("div",null,[s(g,{modelValue:o.value.description,"onUpdate:modelValue":e[18]||(e[18]=a=>o.value.description=a),stateful:"",name:"description",clearable:"",label:"Detalle del servicio",class:"mb-3",readonly:q.value,rules:[c(y).required]},null,8,["modelValue","readonly","rules"])]),n("div",null,[z((x(),Z(g,{modelValue:o.value.fee,"onUpdate:modelValue":e[19]||(e[19]=a=>o.value.fee=a),stateful:"",name:"fee",clearable:"",label:"Tarifa base",class:"mb-3",readonly:q.value,onChange:e[20]||(e[20]=()=>{o.value.fee=c(ee.ceil)(o.value.fee,2)})},{prependInner:t(()=>[El]),_:1},8,["modelValue","readonly"])),[[c(p)]])])]),n("div",Nl,[Ul,s(Ae,{content:o.value.specifications,"onUpdate:content":e[21]||(e[21]=a=>o.value.specifications=a),theme:"snow","content-type":"html",toolbar:["bold","italic"]},null,8,["content"])])]),_:1},512)]),q.value?fe("",!0):(x(),H("div",jl,[s(f,{class:"pr-2 pl-1",icon:"save",color:"primary",loading:ue.value,onClick:Te},{default:t(()=>[Al]),_:1},8,["loading"])]))])]),_:1},8,["modelValue"]),s(nl)]),s(X,{modelValue:j.value,"onUpdate:modelValue":e[24]||(e[24]=a=>j.value=a),size:"250px","hide-default-actions":"","no-dismiss":"",blur:""},{footer:t(()=>[s(f,{size:"small",preset:"secondary",class:"mr-1",onClick:e[23]||(e[23]=a=>K(null,""))},{default:t(()=>[V(" Cancelar")]),_:1}),s(f,{size:"small",loading:A.value,onClick:$e},{default:t(()=>[V(" Continuar")]),_:1},8,["loading"])]),default:t(()=>[ql]),_:1},8,["modelValue"])],64)}}});export{Ol as _};
//# sourceMappingURL=Masters.vue_vue_type_script_setup_true_lang-9f091beb.js.map
