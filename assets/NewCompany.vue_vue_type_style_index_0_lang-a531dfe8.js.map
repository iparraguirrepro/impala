{"version":3,"file":"NewCompany.vue_vue_type_style_index_0_lang-a531dfe8.js","sources":["../../src/core/requests/Contacts.ts","../../src/core/requests/Company.ts","../../src/pages/customers/pages/NewCompany.vue"],"sourcesContent":["import { API } from '../constants'\n\nconst services = {\n  list: API + '/contacts',\n  delete: API + '/contacts',\n  detail: API + '/contacts',\n  register: API + '/contacts',\n}\n\nconst _token = localStorage.getItem('__token')\n\nexport async function getAllContacts(params?: any) {\n  const requestOptions = {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: 'Bearer ' + _token,\n    },\n  }\n  let res = null\n\n  await fetch(\n    params\n      ? `${services.list}?start_date=${params.start || ''}&end_date=${params.end || ''}&status=${params.status || ''}`\n      : services.list,\n    requestOptions,\n  ).then((response) => {\n    res = response.json()\n  })\n\n  return res\n}\n\nexport async function newContact(body: any) {\n  const requestOptions = {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: 'Bearer ' + _token,\n    },\n    body: JSON.stringify(body),\n  }\n  let res = null\n\n  await fetch(services.register, requestOptions).then((response) => {\n    res = response.json()\n  })\n\n  return res\n}\n\nexport async function archiveContact(id: any) {\n  const requestOptions = {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: 'Bearer ' + _token,\n    },\n  }\n  let res = null\n\n  await fetch(`${services.register}/${id}/archive`, requestOptions).then((response) => {\n    res = response.json()\n  })\n\n  return res\n}\n\nexport async function deleteContact(id: any) {\n  const requestOptions = {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: 'Bearer ' + _token,\n    },\n  }\n  let res = null\n\n  await fetch(`${services.delete}/${id}`, requestOptions).then((response) => {\n    res = response.json()\n  })\n\n  return res\n}\n\nexport async function getById(id: any) {\n  const requestOptions = {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: 'Bearer ' + _token,\n    },\n  }\n  let res = null\n\n  await fetch(`${services.detail}/${id}`, requestOptions).then((response) => {\n    res = response.json()\n  })\n\n  return res\n}\n\nexport async function updateById(id: any, body: any) {\n  const requestOptions = {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: 'Bearer ' + _token,\n    },\n    body: JSON.stringify(body),\n  }\n  let res = null\n\n  await fetch(`${services.detail}/${id}`, requestOptions).then((response) => {\n    res = response.json()\n  })\n\n  return res\n}\n","import { API } from '../constants'\r\n\r\nconst services = {\r\n  list: API + '/companies',\r\n  delete: API + '/companies',\r\n  detail: API + '/companies',\r\n  register: API + '/companies',\r\n}\r\n\r\nconst _token = localStorage.getItem('__token')\r\n\r\nexport async function getAllCompanies(params?: any) {\r\n  const requestOptions = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + _token,\r\n    },\r\n  }\r\n  let res = null\r\n\r\n  await fetch(\r\n    params\r\n      ? `${services.list}?start_date=${params.start || ''}&end_date=${params.end || ''}&status=${params.status || ''}`\r\n      : services.list,\r\n    requestOptions,\r\n  ).then((response) => {\r\n    res = response.json()\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nexport async function newCompany(body: any) {\r\n  const requestOptions = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + _token,\r\n    },\r\n    body: JSON.stringify(body),\r\n  }\r\n  let res = null\r\n\r\n  await fetch(services.register, requestOptions).then((response) => {\r\n    res = response.json()\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nexport async function deleteCompany(id: any) {\r\n  const requestOptions = {\r\n    method: 'DELETE',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + _token,\r\n    },\r\n  }\r\n  let res = null\r\n\r\n  await fetch(`${services.delete}/${id}`, requestOptions).then((response) => {\r\n    res = response.json()\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nexport async function getCompanyById(id: any) {\r\n  const requestOptions = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + _token,\r\n    },\r\n  }\r\n  let res = null\r\n\r\n  await fetch(`${services.detail}/${id}`, requestOptions).then((response) => {\r\n    res = response.json()\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nexport async function updateCompanyById(id: any, body: any) {\r\n  const requestOptions = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + _token,\r\n    },\r\n    body: JSON.stringify(body),\r\n  }\r\n  let res = null\r\n\r\n  await fetch(`${services.detail}/${id}`, requestOptions).then((response) => {\r\n    res = response.json()\r\n  })\r\n\r\n  return res\r\n}\r\n","<script setup lang=\"ts\">\r\nimport { reactive, ref, onMounted } from 'vue'\r\nimport { useForm } from 'vuestic-ui'\r\nimport { useI18n } from 'vue-i18n'\r\nimport { useToast } from 'vuestic-ui'\r\nimport { newCompany, updateCompanyById } from '../../../core/requests/Company'\r\nimport { validators } from '../../../services/utils'\r\nimport { onlyNumbersNoDigits } from '../../../core/helpers'\r\n\r\nconst emit = defineEmits(['close'])\r\n\r\nconst vOnlyNumbers = onlyNumbersNoDigits\r\n\r\nconst props = defineProps({\r\n  data: {\r\n    default: null,\r\n    type: Object,\r\n  },\r\n})\r\n\r\nconst { t } = useI18n()\r\nconst isLoading = ref(false)\r\nconst { isValid, validate, reset } = useForm('formRef')\r\nconst form: any = reactive({})\r\nconst { notify } = useToast()\r\n\r\nonMounted(() => {\r\n  if (props.data) {\r\n    form.socialreason = props.data?.socialreason\r\n    form.ruc = props.data?.ruc\r\n    form.whatsapp = props.data?.whatsapp\r\n    form.phone = props.data?.phone\r\n    form.address = props.data?.address\r\n  }\r\n})\r\n\r\nconst doProcess = async () => {\r\n  if (validate()) {\r\n    isLoading.value = true\r\n    try {\r\n      if (props.data) {\r\n        await updateCompanyById(props.data?.id, form)\r\n\r\n        notify({\r\n          message: 'Emnpresa actualizada correctamente',\r\n          color: 'success',\r\n        })\r\n      } else {\r\n        await newCompany(form)\r\n\r\n        notify({\r\n          message: 'Emnpresa registrada correctamente',\r\n          color: 'success',\r\n        })\r\n\r\n        reset()\r\n      }\r\n\r\n      emit('close')\r\n    } catch (e: any) {\r\n      console.log(e)\r\n    }\r\n\r\n    isLoading.value = false\r\n  }\r\n}\r\nconst openSunatRuc = () => {\r\n  window.open(\r\n    'https://e-consultaruc.sunat.gob.pe/cl-ti-itmrconsruc/FrameCriterioBusquedaWeb.jsp',\r\n    '_blank',\r\n    'menubar=1,resizable=0,width=600,height=500',\r\n  )\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"bg-blue-50\">\r\n    <div class=\"mb-4\">\r\n      <div class=\"flex justify-between align-center justify-center\">\r\n        <h1 class=\"h5 font-bold m-0\">{{ t('contacts.newCompany') }}</h1>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"new-customer gap-8\">\r\n      <VaForm v-if=\"!$props.data || form.socialreason\" ref=\"formRef\" immediate class=\"gap-2\">\r\n        <div class=\"w-full bg-white p-2 mt-3 mb-4 py-5\">\r\n          <div class=\"gap-2\">\r\n            <div class=\"w-full columns-1\">\r\n              <div class=\"w-full\">\r\n                <VaInput\r\n                  v-model=\"form.socialreason\"\r\n                  maxlength=\"40\"\r\n                  stateful\r\n                  clearable\r\n                  name=\"company_socialreason\"\r\n                  label=\"Razón social\"\r\n                  :rules=\"[validators.required]\"\r\n                />\r\n              </div>\r\n\r\n              <div class=\"w-full mt-2\">\r\n                <!-- <ImpalaRuc :model=\"form.ruc\" @complete=\"(e) => (form.ruc = e)\" /> -->\r\n                <VaInput\r\n                  v-model=\"form.ruc\"\r\n                  v-only-numbers\r\n                  maxlength=\"20\"\r\n                  name=\"ruc\"\r\n                  stateful\r\n                  clearable\r\n                  label=\"RUC\"\r\n                  :rules=\"[validators.required]\"\r\n                >\r\n                  <template #appendInner>\r\n                    <VaIcon name=\"open_in_new\" class=\"cursor-pointer\" @click=\"openSunatRuc()\" />\r\n                  </template>\r\n                </VaInput>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"columns-2 mt-3\">\r\n              <div class=\"w-full\">\r\n                <VaInput\r\n                  v-model=\"form.phone\"\r\n                  v-only-numbers\r\n                  stateful\r\n                  clearable\r\n                  maxlength=\"12\"\r\n                  name=\"company_phone\"\r\n                  label=\"Teléfono\"\r\n                >\r\n                  <template #prependInner>\r\n                    <VaIcon name=\"call\" class=\"material-symbols-outlined -mx-1.5\" color=\"secondary\" />\r\n                  </template>\r\n                </VaInput>\r\n              </div>\r\n              <div class=\"w-full\">\r\n                <VaInput\r\n                  v-model=\"form.whatsapp\"\r\n                  v-only-numbers\r\n                  stateful\r\n                  maxlength=\"12\"\r\n                  clearable\r\n                  name=\"company_whatsapp\"\r\n                  label=\"WhatsApp\"\r\n                >\r\n                  <template #prependInner>\r\n                    <VaIcon name=\"call\" class=\"material-symbols-outlined -mx-1.5\" color=\"secondary\" />\r\n                  </template>\r\n                </VaInput>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"columns-1 mt-3\">\r\n              <div class=\"w-full\">\r\n                <VaInput\r\n                  v-model=\"form.address\"\r\n                  stateful\r\n                  clearable\r\n                  maxlength=\"50\"\r\n                  name=\"company_address\"\r\n                  label=\"Dirección de contacto\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </VaForm>\r\n    </div>\r\n\r\n    <div class=\"pb-3\">\r\n      <div class=\"flex justify-end\">\r\n        <div class=\"flex gap-2\">\r\n          <VaButton icon=\"save\" color=\"primary\" :disabled=\"!isValid\" :loading=\"isLoading\" @click=\"doProcess\">\r\n            <span class=\"text-xs px-1\">{{ props.data ? 'Actualizar empresa' : t('contacts.createCompany') }}</span>\r\n          </VaButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\n.new-customer {\r\n  &-tabs {\r\n    .va-tabs__content {\r\n      width: 100%;\r\n    }\r\n  }\r\n\r\n  .float-profile {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n  }\r\n}\r\n</style>\r\n"],"names":["services","API","_token","getAllContacts","params","requestOptions","res","response","newContact","body","archiveContact","id","deleteContact","getById","updateById","getAllCompanies","newCompany","deleteCompany","updateCompanyById","emit","__emit","vOnlyNumbers","onlyNumbersNoDigits","props","__props","t","useI18n","isLoading","ref","isValid","validate","reset","useForm","form","reactive","notify","useToast","onMounted","_a","_b","_c","_d","_e","doProcess","e","openSunatRuc"],"mappings":"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"}