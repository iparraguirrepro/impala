{"version":3,"file":"Settings-71829dab.js","sources":["../../src/core/requests/General.ts","../../src/pages/settings/pages/Company.vue","../../src/pages/settings/employee/NewEmployee.vue","../../src/pages/settings/employee/Employees.vue","../../src/pages/settings/Services.vue","../../src/pages/settings/VehicleDrivers.vue","../../src/pages/settings/Settings.vue"],"sourcesContent":["import { API } from '../constants'\r\n\r\nconst services = {\r\n  list: API + '/configurations/company',\r\n}\r\n\r\nconst _token = localStorage.getItem('__token')\r\n\r\nconst updateConfig = async (body: any) => {\r\n  const requestOptions = {\r\n    method: 'PUT',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + _token,\r\n    },\r\n    body: JSON.stringify(body),\r\n  }\r\n  let res = null\r\n\r\n  await fetch(services.list, requestOptions).then((response) => {\r\n    res = response.json()\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nconst getData = async () => {\r\n  const requestOptions = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Authorization: 'Bearer ' + _token,\r\n    },\r\n  }\r\n  let res = null\r\n\r\n  await fetch(services.list, requestOptions).then((response) => {\r\n    res = response.json()\r\n  })\r\n\r\n  return res\r\n}\r\n\r\nexport default {\r\n  update: updateConfig,\r\n  getCompany: getData,\r\n}\r\n","<script lang=\"ts\" setup>\r\nimport { onMounted, ref } from 'vue'\r\nimport { useForm, useToast } from 'vuestic-ui'\r\nimport * as company$ from '../../../core/requests/General'\r\n\r\nconst { notify } = useToast()\r\nconst form: any = ref({})\r\nconst { validate } = useForm('formCompany')\r\nconst basic = ref([])\r\nconst isLoading = ref(false)\r\n\r\nonMounted(async () => {\r\n  await getData()\r\n})\r\n\r\nconst toBase64 = async (file: any) => {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader()\r\n    reader.readAsDataURL(file)\r\n    reader.onload = () => resolve(reader.result)\r\n    reader.onerror = reject\r\n  })\r\n}\r\n\r\nasync function getData() {\r\n  isLoading.value = true\r\n  const data: any = await company$.default.getCompany()\r\n  form.value = {\r\n    name: data.name,\r\n    signature: data.signature,\r\n    social_reason: data.social_reason,\r\n    ruc: data.ruc,\r\n    office: data.office,\r\n    email: data.email,\r\n    phone: data.phone,\r\n    conditions: data.conditions,\r\n  }\r\n  isLoading.value = false\r\n}\r\n\r\nconst doUpdate = async () => {\r\n  try {\r\n    validate()\r\n\r\n    if (basic.value.length) {\r\n      const signFile = await toBase64(basic.value[0])\r\n      form.value.sign = signFile\r\n    }\r\n\r\n    await company$.default.update(form.value)\r\n\r\n    notify({\r\n      message: 'Actualizado correctamente',\r\n      color: 'success',\r\n    })\r\n  } catch (e: any) {\r\n    console.log(e)\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"flex flex-col space-y-6 md:space-y-4\">\r\n    <VaCard>\r\n      <VaCardTitle class=\"flex justify-between\">\r\n        Datos de Empresa\r\n        <VaButton class=\"ml-3 pr-2 pl-1\" icon=\"save\" color=\"primary\" @click=\"doUpdate\">Actualizar</VaButton>\r\n      </VaCardTitle>\r\n      <VaCardContent>\r\n        <div>\r\n          <div class=\"flex flex-col mt-4 px-4\">\r\n            <VaForm ref=\"formCompany\" immediate class=\"gap-2\">\r\n              <VaInput\r\n                v-model=\"form.name\"\r\n                stateful\r\n                name=\"name\"\r\n                clearable\r\n                label=\"Nombre de Empresa\"\r\n                class=\"mb-4\"\r\n                :loading=\"isLoading\"\r\n              />\r\n              <VaInput\r\n                v-model=\"form.social_reason\"\r\n                stateful\r\n                name=\"social_reason\"\r\n                clearable\r\n                label=\"Razón Social\"\r\n                class=\"mb-4\"\r\n                :loading=\"isLoading\"\r\n              />\r\n              <VaInput v-model=\"form.ruc\" stateful name=\"ruc\" clearable label=\"RUC\" class=\"mb-4\" :loading=\"isLoading\" />\r\n              <VaInput\r\n                v-model=\"form.office\"\r\n                stateful\r\n                name=\"office\"\r\n                clearable\r\n                label=\"Dirección de Oficina\"\r\n                class=\"mb-4\"\r\n                :loading=\"isLoading\"\r\n              />\r\n              <VaInput\r\n                v-model=\"form.email\"\r\n                stateful\r\n                name=\"email\"\r\n                clearable\r\n                label=\"Correo de Contacto\"\r\n                class=\"mb-4\"\r\n                :loading=\"isLoading\"\r\n              />\r\n              <VaInput\r\n                v-model=\"form.phone\"\r\n                stateful\r\n                name=\"phone\"\r\n                clearable\r\n                label=\"Teléfono de Contacto\"\r\n                class=\"mb-4\"\r\n                :loading=\"isLoading\"\r\n              />\r\n\r\n              <div class=\"mb-4\">\r\n                <div v-if=\"form?.signature\" class=\"my-2 mb-4\">\r\n                  <p class=\"mb-2\" style=\"font-size: 11px; font-weight: 600; color: var(--va-primary)\">Firma:</p>\r\n                  <img :src=\"form?.signature\" style=\"width: 120px\" alt=\"\" />\r\n                </div>\r\n                <VaFileUpload\r\n                  v-model=\"basic\"\r\n                  dropzone\r\n                  drop-zone-text=\"Arrastra o selecciona tu firma\"\r\n                  upload-button-text=\"Buscar\"\r\n                  file-types=\"jpg,jpeg,png\"\r\n                />\r\n                <p v-if=\"basic?.length > 1\" class=\"text-xxs bg-red-100 px-2\">Solo se admite un archivo.</p>\r\n              </div>\r\n\r\n              <div class=\"mb-5\">\r\n                <p style=\"font-size: 11px; font-weight: 600; color: var(--va-primary)\">Condiciones Generales:</p>\r\n                <QuillEditor\r\n                  v-model:content=\"form.conditions\"\r\n                  theme=\"snow\"\r\n                  content-type=\"html\"\r\n                  :toolbar=\"['bold', 'italic']\"\r\n                />\r\n              </div>\r\n            </VaForm>\r\n          </div>\r\n          <div class=\"flex justify-end\">\r\n            <VaButton class=\"pr-2 pl-1\" icon=\"save\" color=\"primary\" @click=\"doUpdate\">\r\n              <span class=\"ml-2\">Actualizar</span>\r\n            </VaButton>\r\n          </div>\r\n        </div>\r\n      </VaCardContent>\r\n    </VaCard>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n.va-file-upload__field__text {\r\n  font-size: 11px;\r\n}\r\n\r\n.va-button--small .va-button__content {\r\n  font-size: 11px !important;\r\n}\r\n</style>\r\n","<script setup lang=\"ts\">\r\nimport { onMounted, reactive, ref } from 'vue'\r\nimport { useForm } from 'vuestic-ui'\r\nimport { useToast } from 'vuestic-ui'\r\nimport Employee from '../../../core/requests/Employee'\r\nimport { validators } from '../../../services/utils'\r\n\r\nconst emit = defineEmits(['close'])\r\n\r\nconst props = defineProps({\r\n  data: {\r\n    default: null,\r\n    type: Object,\r\n  },\r\n})\r\n\r\nconst isLoading = ref(false)\r\nconst { isValid, validate } = useForm('formRef')\r\nconst form: any = reactive({\r\n  ...(props.data && {\r\n    names: props.data?.names,\r\n    lastnames: props.data?.lastnames,\r\n    email: props.data?.email,\r\n    phone: props.data?.phone,\r\n    status: props.data?.status,\r\n  }),\r\n})\r\nconst { notify } = useToast()\r\n\r\nonMounted(() => {\r\n  console.log(props.data)\r\n})\r\n\r\nconst doProcess = async () => {\r\n  if (validate()) {\r\n    isLoading.value = true\r\n    try {\r\n      const body: any = {\r\n        ...form,\r\n        status: form.status ? 1 : 0,\r\n      }\r\n\r\n      const response: any = props.data ? await Employee.update(body, props.data.id) : await Employee.register(body)\r\n\r\n      if (response.status == true) {\r\n        notify({ message: 'Trabajador grabado correctamente', color: 'primary' })\r\n        emit('close')\r\n      } else {\r\n        notify({ message: 'Error al grabar trabajador', color: 'danger' })\r\n      }\r\n    } catch (e: any) {\r\n      console.log(e)\r\n    }\r\n\r\n    isLoading.value = false\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"bg-blue-50\">\r\n    <div class=\"mb-4\">\r\n      <div class=\"flex justify-between align-center justify-center\">\r\n        <h1 class=\"h5 font-bold m-0\">{{ $props.data?.username ? 'Editar' : 'Nuevo' }} Trabajador</h1>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"new-employee gap-8\">\r\n      <VaForm ref=\"formRef\" immediate class=\"gap-2\">\r\n        <div class=\"w-full bg-white p-2 pb-5 mb-4\">\r\n          <div class=\"gap-2\">\r\n            <div class=\"columns-1 mt-1\">\r\n              <div class=\"w-full mb-2\">\r\n                <VaInput v-model=\"form.names\" :rules=\"[validators.required]\" stateful clearable label=\"Nombres\" />\r\n              </div>\r\n\r\n              <div class=\"w-full mb-2\">\r\n                <VaInput v-model=\"form.lastnames\" :rules=\"[validators.required]\" stateful clearable label=\"Apellidos\" />\r\n              </div>\r\n\r\n              <div class=\"w-full mb-4\">\r\n                <VaInput v-model=\"form.phone\" :rules=\"[validators.required]\" stateful clearable label=\"Teléfono\" />\r\n              </div>\r\n\r\n              <div class=\"w-full\">\r\n                <VaSwitch v-model=\"form.status\" size=\"small\" label=\"Estado\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </VaForm>\r\n    </div>\r\n\r\n    <div class=\"pb-3\">\r\n      <div class=\"flex justify-end\">\r\n        <div class=\"flex gap-2\">\r\n          <VaButton icon=\"save\" color=\"primary\" :disabled=\"!isValid\" :loading=\"isLoading\" @click=\"doProcess\">\r\n            <span class=\"text-xs px-1\">Grabar Trabajador</span>\r\n          </VaButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\n.new-employee {\r\n  &-tabs {\r\n    .va-tabs__content {\r\n      width: 100%;\r\n    }\r\n  }\r\n\r\n  .float-profile {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n  }\r\n\r\n  .va-switch__label {\r\n    font-size: 12px;\r\n  }\r\n}\r\n</style>\r\n","<script lang=\"ts\" setup>\r\nimport { onMounted, ref } from 'vue'\r\nimport { format } from 'date-fns'\r\nimport NewEmployee from './NewEmployee.vue'\r\nimport Employee from '../../../core/requests/Employee'\r\n\r\nconst data: any = ref([])\r\nconst showConfirm: any = ref(null)\r\nconst isDeleting = ref(false)\r\nconst isLoading = ref(false)\r\nconst showNewUser = ref(false)\r\nconst selectedUser: any = ref(null)\r\n\r\nonMounted(() => {\r\n  getData()\r\n})\r\n\r\nconst getData = async () => {\r\n  isLoading.value = true\r\n  showNewUser.value = false\r\n  const _data: any = await Employee.getAll()\r\n  data.value = _data.map((e: any) => ({\r\n    ...e,\r\n    status: !!e.status,\r\n    loading: false,\r\n    created_at: format(new Date(e.created_at), 'dd/MM/yyyy'),\r\n  }))\r\n  isLoading.value = false\r\n}\r\nconst doDelete = async () => {\r\n  isDeleting.value = true\r\n  await Employee.delete(showConfirm.value?.id)\r\n  showConfirm.value = null\r\n  getData()\r\n  isDeleting.value = false\r\n}\r\nconst doDisable = async (e: any) => {\r\n  e.loading = true\r\n  await Employee.update(\r\n    {\r\n      names: e?.names,\r\n      lastnames: e?.lastnames,\r\n      // email: e?.email,\r\n      phone: e?.phone,\r\n      status: e?.status ? 1 : 0,\r\n    },\r\n    e?.id,\r\n  )\r\n  getData()\r\n  e.loading = false\r\n}\r\nconst select4Edit = (data: any) => {\r\n  selectedUser.value = data\r\n  showNewUser.value = true\r\n}\r\nconst openNewUser = () => {\r\n  showNewUser.value = true\r\n  selectedUser.value = null\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"flex flex-col space-y-6 md:space-y-4\">\r\n    <VaInnerLoading :loading=\"isLoading\">\r\n      <VaCard>\r\n        <VaCardTitle class=\"d-flex justify-between\">\r\n          Administración de trabajadores\r\n          <VaButton icon=\"add\" color=\"primary\" @click=\"openNewUser\">\r\n            <span class=\"px-1\">Nuevo Trabajador</span>\r\n          </VaButton>\r\n        </VaCardTitle>\r\n        <VaCardContent>\r\n          <div class=\"flex flex-col p-4 bg-backgroundSecondary rounded-lg\">\r\n            <div class=\"va-table-responsive\">\r\n              <table class=\"va-table w-full text-xs\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>#</th>\r\n                    <th>Nombres Completos</th>\r\n                    <!-- <th>Correo Electrónico</th> -->\r\n                    <th>Teléfono</th>\r\n                    <th>Estado</th>\r\n                    <th></th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr v-for=\"t in data\" :key=\"t.id\">\r\n                    <td>00{{ t.id }}</td>\r\n                    <td>{{ t.names }} {{ t.lastnames }}</td>\r\n                    <!-- <td>{{ t.email }}</td> -->\r\n                    <td>{{ t.phone }}</td>\r\n                    <td>\r\n                      <VaSwitch\r\n                        v-model=\"t.status\"\r\n                        :loading=\"t.loading\"\r\n                        size=\"small\"\r\n                        @update:modelValue=\"doDisable(t)\"\r\n                      />\r\n                    </td>\r\n                    <td>\r\n                      <div class=\"flex gap-1\">\r\n                        <VaButton icon=\"edit\" color=\"primary\" round @click=\"select4Edit(t)\"></VaButton>\r\n                        <VaButton icon=\"delete\" color=\"danger\" round @click=\"showConfirm = t\"></VaButton>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </VaCardContent>\r\n      </VaCard>\r\n    </VaInnerLoading>\r\n\r\n    <VaModal v-model=\"showNewUser\" size=\"360px\" close-button hide-default-actions blur no-dismiss>\r\n      <div>\r\n        <NewEmployee :data=\"selectedUser\" @close=\"getData\" />\r\n      </div>\r\n    </VaModal>\r\n\r\n    <VaModal v-model=\"showConfirm\" size=\"250px\" hide-default-actions no-dismiss blur>\r\n      <p class=\"text-sm\">¿Deseas eliminar este trabajador?</p>\r\n\r\n      <template #footer>\r\n        <VaButton size=\"small\" preset=\"secondary\" class=\"mr-1\" @click=\"showConfirm = null\"> Cancelar</VaButton>\r\n        <VaButton :loading=\"isDeleting\" size=\"small\" @click=\"doDelete\"> Continuar</VaButton>\r\n      </template>\r\n    </VaModal>\r\n  </div>\r\n</template>\r\n","<script lang=\"ts\" setup>\r\nimport { onMounted, ref } from 'vue'\r\nimport { useForm, useToast } from 'vuestic-ui'\r\nimport { deleteService, getAllServices, newService } from '../../core/requests/Services'\r\nimport { validators } from '../../services/utils'\r\nimport { onlyNumbers } from '../../core/helpers'\r\nimport { ceil } from 'lodash'\r\n\r\nconst vOnlyDigits = onlyNumbers\r\n\r\nconst { notify } = useToast()\r\nconst servicesColumns = [\r\n  { key: 'Servicio', sortable: true },\r\n  { key: 'Descripción', sortable: true },\r\n  { key: 'Tarifa base', sortable: true },\r\n  { key: 'Acciones', width: 80 },\r\n]\r\nconst services = ref([])\r\nconst itemSelected = ref(null)\r\nconst showNewService = ref(false)\r\nconst showConfirm = ref(false)\r\nconst isDeleting = ref(false)\r\nconst selectedType: any = ref(null)\r\nconst formService: any = ref({})\r\nconst { validate: serviceValidate, reset: serviceReset } = useForm('fgService')\r\n\r\nonMounted(() => {\r\n  getServices()\r\n})\r\n\r\nconst loadingServices = ref(false)\r\nasync function getServices() {\r\n  loadingServices.value = true\r\n  const servicesData: any = await getAllServices()\r\n  services.value = servicesData.map((i: any) => ({\r\n    ...i,\r\n    Servicio: i.service,\r\n    Descripción: i.description,\r\n    'Tarifa base': i.fee ? `S/ ${i.fee || '0.00'}` : '-',\r\n  }))\r\n  loadingServices.value = false\r\n}\r\n\r\nconst doDelete = async () => {\r\n  if (selectedType.value === 'service') {\r\n    await deleteService(itemSelected.value)\r\n    await getServices()\r\n  }\r\n\r\n  selectedType.value = null\r\n  showConfirm.value = false\r\n}\r\n\r\nconst loadingNewService = ref(false)\r\nconst doNewService = async () => {\r\n  try {\r\n    serviceValidate()\r\n    loadingNewService.value = true\r\n    await newService({\r\n      ...formService.value,\r\n    })\r\n\r\n    await getServices()\r\n\r\n    notify({\r\n      message: 'Servicio registrado correctamente',\r\n      color: 'success',\r\n    })\r\n    loadingNewService.value = false\r\n\r\n    serviceReset()\r\n    formService.value = {}\r\n    showNewService.value = false\r\n  } catch (e: any) {\r\n    console.log(e)\r\n  }\r\n}\r\nconst needConfirm = (id: any, type: string) => {\r\n  showConfirm.value = id ? true : false\r\n  itemSelected.value = id\r\n  selectedType.value = type\r\n}\r\nconst showViewService = ref(false)\r\nconst viewService = (data: any) => {\r\n  showNewService.value = true\r\n  showViewService.value = true\r\n  formService.value = data\r\n}\r\nconst closeViewService = () => {\r\n  formService.value = {}\r\n  showViewService.value = false\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"flex flex-col space-y-6 md:space-y-4\">\r\n    <VaCard>\r\n      <VaCardTitle class=\"flex justify-between\">\r\n        Servicios\r\n        <VaButton class=\"ml-3 pr-2 pl-1\" icon=\"add\" color=\"primary\" @click=\"showNewService = true\">Agregar</VaButton>\r\n      </VaCardTitle>\r\n      <VaCardContent>\r\n        <div class=\"flex flex-col p-4 bg-backgroundSecondary rounded-lg\">\r\n          <VaDataTable :items=\"services\" :columns=\"servicesColumns\" class=\"text-xs\" :loading=\"loadingServices\">\r\n            <template #cell(Acciones)=\"{ row }\">\r\n              <div class=\"flex gap-1\">\r\n                <VaButton icon=\"visibility\" color=\"info\" round @click=\"viewService(row?.rowData)\"></VaButton>\r\n                <VaButton\r\n                  icon=\"delete\"\r\n                  color=\"danger\"\r\n                  round\r\n                  @click=\"needConfirm(row?.rowData?.id, 'service')\"\r\n                ></VaButton>\r\n              </div>\r\n            </template>\r\n          </VaDataTable>\r\n        </div>\r\n      </VaCardContent>\r\n    </VaCard>\r\n\r\n    <VaModal\r\n      v-model=\"showNewService\"\r\n      hide-default-actions\r\n      size=\"400px\"\r\n      close-button\r\n      no-dismiss\r\n      blur\r\n      @beforeClose=\"closeViewService\"\r\n    >\r\n      <div>\r\n        <h4 v-if=\"!showViewService\" class=\"text-base mb-4\">Nuevo Servicio</h4>\r\n        <h4 v-if=\"showViewService\" class=\"text-base mb-4\">Detalle de Servicio</h4>\r\n        <div class=\"flex flex-col\">\r\n          <VaForm ref=\"fgService\" immediate class=\"gap-2\">\r\n            <VaInput\r\n              v-model=\"formService.service\"\r\n              stateful\r\n              name=\"service\"\r\n              clearable\r\n              label=\"Tipo de servicio\"\r\n              class=\"mb-3\"\r\n              :readonly=\"showViewService\"\r\n              :rules=\"[validators.required]\"\r\n            />\r\n\r\n            <div class=\"columns-2\">\r\n              <div>\r\n                <VaInput\r\n                  v-model=\"formService.description\"\r\n                  stateful\r\n                  name=\"description\"\r\n                  clearable\r\n                  label=\"Detalle del servicio\"\r\n                  class=\"mb-3\"\r\n                  :readonly=\"showViewService\"\r\n                  :rules=\"[validators.required]\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <VaInput\r\n                  v-model=\"formService.fee\"\r\n                  v-only-digits\r\n                  stateful\r\n                  name=\"fee\"\r\n                  clearable\r\n                  label=\"Tarifa base\"\r\n                  class=\"mb-3\"\r\n                  :readonly=\"showViewService\"\r\n                  :rules=\"[validators.required]\"\r\n                  @change=\"\r\n                    () => {\r\n                      formService.fee = ceil(formService.fee, 2)\r\n                    }\r\n                  \"\r\n                >\r\n                  <template #prependInner>\r\n                    <span class=\"pr-2 font-bold text-sm\">S/</span>\r\n                  </template>\r\n                </VaInput>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"mb-5\">\r\n              <p style=\"font-size: 11px; font-weight: 600; color: var(--va-primary)\">Condiciones especificas:</p>\r\n              <QuillEditor\r\n                v-model:content=\"formService.specifications\"\r\n                theme=\"snow\"\r\n                content-type=\"html\"\r\n                :toolbar=\"['bold', 'italic']\"\r\n              />\r\n            </div>\r\n          </VaForm>\r\n        </div>\r\n        <div v-if=\"!showViewService\" class=\"flex\">\r\n          <VaButton class=\"pr-2 pl-1\" icon=\"save\" color=\"primary\" :loading=\"loadingNewService\" @click=\"doNewService\">\r\n            <span class=\"ml-2\">Registrar</span>\r\n          </VaButton>\r\n        </div>\r\n      </div>\r\n    </VaModal>\r\n  </div>\r\n\r\n  <VaModal v-model=\"showConfirm\" size=\"250px\" hide-default-actions no-dismiss blur>\r\n    <p class=\"text-sm\">¿Deseas continuar?</p>\r\n\r\n    <template #footer>\r\n      <VaButton size=\"small\" preset=\"secondary\" class=\"mr-1\" @click=\"needConfirm(null, '')\"> Cancelar</VaButton>\r\n      <VaButton size=\"small\" :loading=\"isDeleting\" @click=\"doDelete\"> Continuar</VaButton>\r\n    </template>\r\n  </VaModal>\r\n</template>\r\n","<script lang=\"ts\" setup>\r\nimport { onMounted, ref } from 'vue'\r\nimport { useForm, useToast } from 'vuestic-ui'\r\nimport { deleteDriver, getAllDrivers, newDriver } from '../../core/requests/Drivers'\r\nimport { validators } from '../../services/utils'\r\nimport { onlyNumbers } from '../../core/helpers'\r\nimport { ceil } from 'lodash'\r\n\r\nconst vOnlyDigits = onlyNumbers\r\n\r\nconst { notify } = useToast()\r\nconst driversColumns = [\r\n  { key: 'Tipo Conductor', sortable: true },\r\n  { key: 'Tarifa', sortable: true },\r\n  { key: 'Acciones', width: 80 },\r\n]\r\nconst drivers = ref([])\r\nconst itemSelected = ref(null)\r\nconst showNewDriver = ref(false)\r\nconst showConfirm = ref(false)\r\nconst isDeleting = ref(false)\r\nconst selectedType: any = ref(null)\r\nconst formDriver: any = ref({})\r\nconst { validate: driverValidate, reset: driverReset } = useForm('fgDriver')\r\nuseForm('fgCurrency')\r\n\r\nonMounted(() => {\r\n  getDrivers()\r\n})\r\n\r\nconst loadingDrivers = ref(false)\r\nasync function getDrivers() {\r\n  loadingDrivers.value = true\r\n  const driversData: any = await getAllDrivers()\r\n  drivers.value = driversData.map((i: any) => ({\r\n    ...i,\r\n    'Tipo Conductor': i.type,\r\n    Tarifa: i.fee ? `S/ ${i.fee || '0.00'}` : '-',\r\n  }))\r\n  loadingDrivers.value = false\r\n}\r\n\r\nconst doDelete = async () => {\r\n  if (selectedType.value === 'drivers') {\r\n    await deleteDriver(itemSelected.value)\r\n    await getDrivers()\r\n  }\r\n\r\n  selectedType.value = null\r\n  showConfirm.value = false\r\n}\r\n\r\nconst loadingNewDriver = ref(false)\r\nconst doNewDriver = async () => {\r\n  try {\r\n    driverValidate()\r\n    loadingNewDriver.value = true\r\n    await newDriver({\r\n      ...formDriver.value,\r\n    })\r\n\r\n    await getDrivers()\r\n\r\n    notify({\r\n      message: 'Conductor registrado correctamente',\r\n      color: 'success',\r\n    })\r\n\r\n    loadingNewDriver.value = false\r\n\r\n    driverReset()\r\n    showNewDriver.value = false\r\n  } catch (e: any) {\r\n    console.log(e)\r\n  }\r\n}\r\n\r\nconst needConfirm = (id: any, type: string) => {\r\n  showConfirm.value = id ? true : false\r\n  itemSelected.value = id\r\n  selectedType.value = type\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"flex flex-col space-y-6 md:space-y-4\">\r\n    <VaCard>\r\n      <VaCardTitle class=\"flex justify-between\">\r\n        Conductores\r\n        <VaButton class=\"ml-3 pr-2 pl-1\" icon=\"add\" color=\"primary\" @click=\"showNewDriver = true\">Agregar</VaButton>\r\n      </VaCardTitle>\r\n      <VaCardContent>\r\n        <div class=\"flex flex-col p-4 bg-backgroundSecondary rounded-lg\">\r\n          <VaDataTable :items=\"drivers\" :columns=\"driversColumns\" class=\"text-xs\" :loading=\"loadingDrivers\">\r\n            <template #cell(Acciones)=\"{ row }\">\r\n              <div class=\"flex gap-1\">\r\n                <VaButton\r\n                  icon=\"delete\"\r\n                  color=\"danger\"\r\n                  round\r\n                  @click=\"needConfirm(row?.rowData?.id, 'drivers')\"\r\n                ></VaButton>\r\n              </div>\r\n            </template>\r\n          </VaDataTable>\r\n        </div>\r\n      </VaCardContent>\r\n    </VaCard>\r\n\r\n    <VaModal v-model=\"showNewDriver\" hide-default-actions size=\"300px\" close-button blur no-dismiss @ok=\"doNewDriver\">\r\n      <div>\r\n        <h4 class=\"text-base mb-4\">Nuevo tipo de conductor</h4>\r\n        <div class=\"flex flex-col\">\r\n          <VaForm ref=\"fgDriver\" immediate class=\"gap-2\">\r\n            <VaInput\r\n              v-model=\"formDriver.type\"\r\n              stateful\r\n              name=\"type\"\r\n              clearable\r\n              label=\"Tipo de chofer\"\r\n              class=\"mb-3\"\r\n              :rules=\"[validators.required]\"\r\n            />\r\n\r\n            <VaInput\r\n              v-model=\"formDriver.fee\"\r\n              v-only-digits\r\n              stateful\r\n              name=\"fee\"\r\n              clearable\r\n              label=\"Tarifa por Hora\"\r\n              class=\"mb-5\"\r\n              :rules=\"[validators.required]\"\r\n              @change=\"\r\n                () => {\r\n                  formDriver.fee = ceil(formDriver.fee, 2)\r\n                }\r\n              \"\r\n            >\r\n              <template #prependInner>\r\n                <span class=\"pr-2 font-bold text-sm\">S/</span>\r\n              </template>\r\n            </VaInput>\r\n          </VaForm>\r\n        </div>\r\n        <div class=\"flex\">\r\n          <VaButton class=\"pr-2 pl-1\" icon=\"save\" color=\"primary\" :loading=\"loadingNewDriver\" @click=\"doNewDriver\">\r\n            <span class=\"ml-2\">Registrar</span>\r\n          </VaButton>\r\n        </div>\r\n      </div>\r\n    </VaModal>\r\n  </div>\r\n\r\n  <VaModal v-model=\"showConfirm\" size=\"250px\" hide-default-actions no-dismiss blur>\r\n    <p class=\"text-sm\">¿Deseas continuar?</p>\r\n\r\n    <template #footer>\r\n      <VaButton size=\"small\" preset=\"secondary\" class=\"mr-1\" @click=\"needConfirm(null, '')\"> Cancelar</VaButton>\r\n      <VaButton size=\"small\" :loading=\"isDeleting\" @click=\"doDelete\"> Continuar</VaButton>\r\n    </template>\r\n  </VaModal>\r\n</template>\r\n","<script lang=\"ts\" setup>\r\nimport { ref } from 'vue'\r\nimport Masters from './Masters.vue'\r\nimport General from './General.vue'\r\nimport Company from './pages/Company.vue'\r\nimport Users from './Users.vue'\r\nimport Employees from './employee/Employees.vue'\r\nimport Vehicles from './Vehicles.vue'\r\nimport Services from './Services.vue'\r\nimport VehicleDrivers from './VehicleDrivers.vue'\r\nimport Expenses from './pages/Expenses.vue'\r\n\r\nconst tabs = [\r\n  { icon: '', title: 'Datos de Empresa', content: '' },\r\n  // { icon: '', title: 'Configuración General', content: '' },\r\n  { icon: '', title: 'Maestro de Vehiculos', content: '' },\r\n  { icon: '', title: 'Maestro de Rutas', content: '' },\r\n  { icon: '', title: 'Maestro de Servicios', content: '' },\r\n  { icon: '', title: 'Maestro de Conductores', content: '' },\r\n  { icon: '', title: 'Maestro de Viaticos', content: '' },\r\n  { icon: '', title: 'Trabajadores', content: '' },\r\n  { icon: '', title: 'Usuarios', content: '' },\r\n]\r\nconst activeTab = ref(tabs[0].title)\r\n</script>\r\n\r\n<template>\r\n  <div class=\"flex flex-col space-y-6 4\">\r\n    <div class=\"flex justify-between align-center justify-center\">\r\n      <h1 class=\"h5 m-0\">Configuración</h1>\r\n    </div>\r\n\r\n    <div class=\"flex py-3\">\r\n      <div class=\"w-1/4\">\r\n        <VaTabs v-model=\"activeTab\" vertical grow>\r\n          <template #tabs>\r\n            <VaTab v-for=\"tab in tabs\" :key=\"tab.title\" class=\"text-xs py-1 px-0\" :name=\"tab.title\">\r\n              <VaIcon :name=\"tab.icon\" size=\"small\" class=\"mr-2\" />\r\n              {{ tab.title }}\r\n            </VaTab>\r\n          </template>\r\n        </VaTabs>\r\n      </div>\r\n\r\n      <section class=\"settings-section w-4/5 bg-blue-50 px-6 py-5\">\r\n        <Company v-if=\"activeTab === 'Datos de Empresa'\" />\r\n        <Vehicles v-if=\"activeTab === 'Maestro de Vehiculos'\" />\r\n        <General v-if=\"activeTab === 'Maestro de Rutas'\" />\r\n        <Services v-if=\"activeTab === 'Maestro de Servicios'\" />\r\n        <VehicleDrivers v-if=\"activeTab === 'Maestro de Conductores'\" />\r\n        <Expenses v-if=\"activeTab === 'Maestro de Viaticos'\" />\r\n        <Masters v-if=\"activeTab === 'Configuración General'\" />\r\n        <Users v-if=\"activeTab === 'Usuarios'\" />\r\n        <Employees v-if=\"activeTab === 'Trabajadores'\" />\r\n      </section>\r\n    </div>\r\n  </div>\r\n</template>\r\n"],"names":["services","API","_token","updateConfig","body","requestOptions","res","response","getData","General","notify","useToast","form","ref","validate","useForm","basic","isLoading","onMounted","toBase64","file","resolve","reject","reader","data","company$.default","doUpdate","signFile","e","emit","__emit","props","__props","isValid","reactive","_a","_b","_c","_d","_e","doProcess","Employee","showConfirm","isDeleting","showNewUser","selectedUser","_data","format","doDelete","doDisable","select4Edit","openNewUser","vOnlyDigits","onlyNumbers","servicesColumns","itemSelected","showNewService","selectedType","formService","serviceValidate","serviceReset","getServices","loadingServices","servicesData","getAllServices","i","deleteService","loadingNewService","doNewService","newService","needConfirm","id","type","showViewService","viewService","closeViewService","driversColumns","drivers","showNewDriver","formDriver","driverValidate","driverReset","getDrivers","loadingDrivers","driversData","getAllDrivers","deleteDriver","loadingNewDriver","doNewDriver","newDriver","tabs","activeTab"],"mappings":"85BAEA,MAAMA,GAAW,CACf,KAAMC,GAAM,yBACd,EAEMC,GAAS,aAAa,QAAQ,SAAS,EAEvCC,GAAe,MAAOC,GAAc,CACxC,MAAMC,EAAiB,CACrB,OAAQ,MACR,QAAS,CACP,eAAgB,mBAChB,cAAe,UAAYH,EAC7B,EACA,KAAM,KAAK,UAAUE,CAAI,CAAA,EAE3B,IAAIE,EAAM,KAEV,aAAM,MAAMN,GAAS,KAAMK,CAAc,EAAE,KAAME,GAAa,CAC5DD,EAAMC,EAAS,MAAK,CACrB,EAEMD,CACT,EAEME,GAAU,SAAY,CAC1B,MAAMH,EAAiB,CACrB,OAAQ,MACR,QAAS,CACP,eAAgB,mBAChB,cAAe,UAAYH,EAC7B,CAAA,EAEF,IAAII,EAAM,KAEV,aAAM,MAAMN,GAAS,KAAMK,CAAc,EAAE,KAAME,GAAa,CAC5DD,EAAMC,EAAS,MAAK,CACrB,EAEMD,CACT,EAEeG,GAAA,CACb,OAAQN,GACR,WAAYK,EACd,0hBCzCM,KAAA,CAAE,OAAAE,GAAWC,IACbC,EAAYC,EAAI,CAAA,CAAE,EAClB,CAAE,SAAAC,CAAA,EAAaC,EAAQ,aAAa,EACpCC,EAAQH,EAAI,CAAA,CAAE,EACdI,EAAYJ,EAAI,EAAK,EAE3BK,EAAU,SAAY,CACpB,MAAMV,EAAQ,CAAA,CACf,EAEK,MAAAW,EAAW,MAAOC,GACf,IAAI,QAAQ,CAACC,EAASC,IAAW,CAChC,MAAAC,EAAS,IAAI,WACnBA,EAAO,cAAcH,CAAI,EACzBG,EAAO,OAAS,IAAMF,EAAQE,EAAO,MAAM,EAC3CA,EAAO,QAAUD,CAAA,CAClB,EAGH,eAAed,GAAU,CACvBS,EAAU,MAAQ,GAClB,MAAMO,EAAY,MAAMC,GAAiB,aACzCb,EAAK,MAAQ,CACX,KAAMY,EAAK,KACX,UAAWA,EAAK,UAChB,cAAeA,EAAK,cACpB,IAAKA,EAAK,IACV,OAAQA,EAAK,OACb,MAAOA,EAAK,MACZ,MAAOA,EAAK,MACZ,WAAYA,EAAK,UAAA,EAEnBP,EAAU,MAAQ,EACpB,CAEA,MAAMS,EAAW,SAAY,CACvB,GAAA,CAGE,GAFKZ,IAELE,EAAM,MAAM,OAAQ,CACtB,MAAMW,EAAW,MAAMR,EAASH,EAAM,MAAM,CAAC,CAAC,EAC9CJ,EAAK,MAAM,KAAOe,CACpB,CAEA,MAAMF,GAAiB,OAAOb,EAAK,KAAK,EAEjCF,EAAA,CACL,QAAS,4BACT,MAAO,SAAA,CACR,QACMkB,EAAQ,CACf,QAAQ,IAAIA,CAAC,CACf,CAAA,6oGClDF,MAAMC,EAAOC,EAEPC,EAAQC,EAORf,EAAYJ,EAAI,EAAK,EACrB,CAAE,QAAAoB,EAAS,SAAAnB,CAAS,EAAIC,EAAQ,SAAS,EACzCH,EAAYsB,GAAS,CACzB,GAAIH,EAAM,MAAQ,CAChB,OAAOI,EAAAJ,EAAM,OAAN,YAAAI,EAAY,MACnB,WAAWC,EAAAL,EAAM,OAAN,YAAAK,EAAY,UACvB,OAAOC,EAAAN,EAAM,OAAN,YAAAM,EAAY,MACnB,OAAOC,EAAAP,EAAM,OAAN,YAAAO,EAAY,MACnB,QAAQC,EAAAR,EAAM,OAAN,YAAAQ,EAAY,MACtB,CAAA,CACD,EACK,CAAE,OAAA7B,GAAWC,IAEnBO,EAAU,IAAM,CACN,QAAA,IAAIa,EAAM,IAAI,CAAA,CACvB,EAED,MAAMS,EAAY,SAAY,CAC5B,GAAI1B,IAAY,CACdG,EAAU,MAAQ,GACd,GAAA,CACF,MAAMb,EAAY,CAChB,GAAGQ,EACH,OAAQA,EAAK,OAAS,EAAI,CAAA,GAGNmB,EAAM,KAAO,MAAMU,EAAS,OAAOrC,EAAM2B,EAAM,KAAK,EAAE,EAAI,MAAMU,EAAS,SAASrC,CAAI,GAE/F,QAAU,IACrBM,EAAO,CAAE,QAAS,mCAAoC,MAAO,SAAW,CAAA,EACxEmB,EAAK,OAAO,GAEZnB,EAAO,CAAE,QAAS,6BAA8B,MAAO,QAAU,CAAA,QAE5DkB,EAAQ,CACf,QAAQ,IAAIA,CAAC,CACf,CAEAX,EAAU,MAAQ,EACpB,CAAA,osDCjDI,MAAAO,EAAYX,EAAI,CAAA,CAAE,EAClB6B,EAAmB7B,EAAI,IAAI,EAC3B8B,EAAa9B,EAAI,EAAK,EACtBI,EAAYJ,EAAI,EAAK,EACrB+B,EAAc/B,EAAI,EAAK,EACvBgC,EAAoBhC,EAAI,IAAI,EAElCK,EAAU,IAAM,CACNV,GAAA,CACT,EAED,MAAMA,EAAU,SAAY,CAC1BS,EAAU,MAAQ,GAClB2B,EAAY,MAAQ,GACd,MAAAE,EAAa,MAAML,EAAS,SAClCjB,EAAK,MAAQsB,EAAM,IAAKlB,IAAY,CAClC,GAAGA,EACH,OAAQ,CAAC,CAACA,EAAE,OACZ,QAAS,GACT,WAAYmB,GAAO,IAAI,KAAKnB,EAAE,UAAU,EAAG,YAAY,CACvD,EAAA,EACFX,EAAU,MAAQ,EAAA,EAEd+B,EAAW,SAAY,OAC3BL,EAAW,MAAQ,GACnB,MAAMF,EAAS,QAAON,EAAAO,EAAY,QAAZ,YAAAP,EAAmB,EAAE,EAC3CO,EAAY,MAAQ,KACZlC,IACRmC,EAAW,MAAQ,EAAA,EAEfM,EAAY,MAAOrB,GAAW,CAClCA,EAAE,QAAU,GACZ,MAAMa,EAAS,OACb,CACE,MAAOb,GAAA,YAAAA,EAAG,MACV,UAAWA,GAAA,YAAAA,EAAG,UAEd,MAAOA,GAAA,YAAAA,EAAG,MACV,OAAQA,GAAA,MAAAA,EAAG,OAAS,EAAI,CAC1B,EACAA,GAAA,YAAAA,EAAG,EAAA,EAEGpB,IACRoB,EAAE,QAAU,EAAA,EAERsB,EAAe1B,GAAc,CACjCqB,EAAa,MAAQrB,EACrBoB,EAAY,MAAQ,EAAA,EAEhBO,EAAc,IAAM,CACxBP,EAAY,MAAQ,GACpBC,EAAa,MAAQ,IAAA,myECjDvB,MAAMO,EAAcC,GAEd,CAAE,OAAA3C,GAAWC,IACb2C,EAAkB,CACtB,CAAE,IAAK,WAAY,SAAU,EAAK,EAClC,CAAE,IAAK,cAAe,SAAU,EAAK,EACrC,CAAE,IAAK,cAAe,SAAU,EAAK,EACrC,CAAE,IAAK,WAAY,MAAO,EAAG,CAAA,EAEzBtD,EAAWa,EAAI,CAAA,CAAE,EACjB0C,EAAe1C,EAAI,IAAI,EACvB2C,EAAiB3C,EAAI,EAAK,EAC1B6B,EAAc7B,EAAI,EAAK,EACvB8B,EAAa9B,EAAI,EAAK,EACtB4C,EAAoB5C,EAAI,IAAI,EAC5B6C,EAAmB7C,EAAI,CAAA,CAAE,EACzB,CAAE,SAAU8C,EAAiB,MAAOC,GAAiB7C,EAAQ,WAAW,EAE9EG,EAAU,IAAM,CACF2C,GAAA,CACb,EAEK,MAAAC,EAAkBjD,EAAI,EAAK,EACjC,eAAegD,GAAc,CAC3BC,EAAgB,MAAQ,GAClB,MAAAC,EAAoB,MAAMC,KAChChE,EAAS,MAAQ+D,EAAa,IAAKE,IAAY,CAC7C,GAAGA,EACH,SAAUA,EAAE,QACZ,YAAaA,EAAE,YACf,cAAeA,EAAE,IAAM,MAAMA,EAAE,KAAO,MAAM,GAAK,GACjD,EAAA,EACFH,EAAgB,MAAQ,EAC1B,CAEA,MAAMd,EAAW,SAAY,CACvBS,EAAa,QAAU,YACnB,MAAAS,GAAcX,EAAa,KAAK,EACtC,MAAMM,EAAY,GAGpBJ,EAAa,MAAQ,KACrBf,EAAY,MAAQ,EAAA,EAGhByB,EAAoBtD,EAAI,EAAK,EAC7BuD,EAAe,SAAY,CAC3B,GAAA,CACcT,IAChBQ,EAAkB,MAAQ,GAC1B,MAAME,GAAW,CACf,GAAGX,EAAY,KAAA,CAChB,EAED,MAAMG,EAAY,EAEXnD,EAAA,CACL,QAAS,oCACT,MAAO,SAAA,CACR,EACDyD,EAAkB,MAAQ,GAEbP,IACbF,EAAY,MAAQ,GACpBF,EAAe,MAAQ,SAChB5B,EAAQ,CACf,QAAQ,IAAIA,CAAC,CACf,CAAA,EAEI0C,EAAc,CAACC,EAASC,IAAiB,CACjC9B,EAAA,MAAQ,EAAA6B,EACpBhB,EAAa,MAAQgB,EACrBd,EAAa,MAAQe,CAAA,EAEjBC,EAAkB5D,EAAI,EAAK,EAC3B6D,EAAelD,GAAc,CACjCgC,EAAe,MAAQ,GACvBiB,EAAgB,MAAQ,GACxBf,EAAY,MAAQlC,CAAA,EAEhBmD,EAAmB,IAAM,CAC7BjB,EAAY,MAAQ,GACpBe,EAAgB,MAAQ,EAAA,s2GClF1B,MAAMrB,EAAcC,GAEd,CAAE,OAAA3C,GAAWC,IACbiE,EAAiB,CACrB,CAAE,IAAK,iBAAkB,SAAU,EAAK,EACxC,CAAE,IAAK,SAAU,SAAU,EAAK,EAChC,CAAE,IAAK,WAAY,MAAO,EAAG,CAAA,EAEzBC,EAAUhE,EAAI,CAAA,CAAE,EAChB0C,EAAe1C,EAAI,IAAI,EACvBiE,EAAgBjE,EAAI,EAAK,EACzB6B,EAAc7B,EAAI,EAAK,EACvB8B,EAAa9B,EAAI,EAAK,EACtB4C,EAAoB5C,EAAI,IAAI,EAC5BkE,EAAkBlE,EAAI,CAAA,CAAE,EACxB,CAAE,SAAUmE,EAAgB,MAAOC,GAAgBlE,EAAQ,UAAU,EAC3EA,EAAQ,YAAY,EAEpBG,EAAU,IAAM,CACHgE,GAAA,CACZ,EAEK,MAAAC,EAAiBtE,EAAI,EAAK,EAChC,eAAeqE,GAAa,CAC1BC,EAAe,MAAQ,GACjB,MAAAC,EAAmB,MAAMC,KAC/BR,EAAQ,MAAQO,EAAY,IAAKnB,IAAY,CAC3C,GAAGA,EACH,iBAAkBA,EAAE,KACpB,OAAQA,EAAE,IAAM,MAAMA,EAAE,KAAO,MAAM,GAAK,GAC1C,EAAA,EACFkB,EAAe,MAAQ,EACzB,CAEA,MAAMnC,EAAW,SAAY,CACvBS,EAAa,QAAU,YACnB,MAAA6B,GAAa/B,EAAa,KAAK,EACrC,MAAM2B,EAAW,GAGnBzB,EAAa,MAAQ,KACrBf,EAAY,MAAQ,EAAA,EAGhB6C,EAAmB1E,EAAI,EAAK,EAC5B2E,EAAc,SAAY,CAC1B,GAAA,CACaR,IACfO,EAAiB,MAAQ,GACzB,MAAME,GAAU,CACd,GAAGV,EAAW,KAAA,CACf,EAED,MAAMG,EAAW,EAEVxE,EAAA,CACL,QAAS,qCACT,MAAO,SAAA,CACR,EAED6E,EAAiB,MAAQ,GAEbN,IACZH,EAAc,MAAQ,SACflD,EAAQ,CACf,QAAQ,IAAIA,CAAC,CACf,CAAA,EAGI0C,EAAc,CAACC,EAASC,IAAiB,CACjC9B,EAAA,MAAQ,EAAA6B,EACpBhB,EAAa,MAAQgB,EACrBd,EAAa,MAAQe,CAAA,o5ECpEvB,MAAMkB,EAAO,CACX,CAAE,KAAM,GAAI,MAAO,mBAAoB,QAAS,EAAG,EAEnD,CAAE,KAAM,GAAI,MAAO,uBAAwB,QAAS,EAAG,EACvD,CAAE,KAAM,GAAI,MAAO,mBAAoB,QAAS,EAAG,EACnD,CAAE,KAAM,GAAI,MAAO,uBAAwB,QAAS,EAAG,EACvD,CAAE,KAAM,GAAI,MAAO,yBAA0B,QAAS,EAAG,EACzD,CAAE,KAAM,GAAI,MAAO,sBAAuB,QAAS,EAAG,EACtD,CAAE,KAAM,GAAI,MAAO,eAAgB,QAAS,EAAG,EAC/C,CAAE,KAAM,GAAI,MAAO,WAAY,QAAS,EAAG,CAAA,EAEvCC,EAAY9E,EAAI6E,EAAK,CAAC,EAAE,KAAK"}