import{A as S,d as Be,i as m,C as Ae,y as Ue,a5 as Ee,u as $e,k as qe,r as p,o as d,c as u,a as e,f as c,t as o,b as s,w as t,h as _,g as j,m as ve,F as I,n as D,V as Me,_ as Ne}from"./index-b45d4e71.js";import{a as Re,e as Fe,b as Pe,d as He,s as Ge,c as Je}from"./Orders-7a56ac88.js";import{E as Ke}from"./Employee-989edf47.js";import{f as Qe}from"./format-8e15a9c0.js";const F={list:S+"/orders/interactions",byid:S+"/orders/interactions",delete:S+"/orders/interactions",register:S+"/orders/interactions"},P=localStorage.getItem("__token");async function We(y){const x={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+P}};let v=null;return await fetch(`${F.list}/${y}`,x).then(h=>{v=h.json()}),v}async function xe(y){const x={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+P}};let v=null;return await fetch(`${F.list}/${y}`,x).then(h=>{v=h.json()}),v}async function Xe(y){const x={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+P},body:JSON.stringify(y)};let v=null;return await fetch(F.register,x).then(h=>{v=h.json()}),v}const Ye={key:0},Ze={class:"flex justify-between align-center"},et={class:"h5 font-bold m-0"},tt={class:"text-primary font-bold pl-1"},st=e("br",null,null,-1),at={class:"text-sm font-medium"},ot={class:"flex gap-2"},lt={key:0,class:"grid-cols-3 space-x-2.5 pt-4"},nt=e("span",{class:"px-1"},"Finalizar Orden",-1),it={class:"px-1"},dt={key:1,class:"grid-cols-3 space-x-2.5 pt-4"},ct=e("span",{class:"px-1"},"Activar Orden",-1),rt=e("hr",{class:"mt-4 mb-2"},null,-1),ut={class:"py-4 order-detail flex columns-2 gap-4"},_t={class:"w-1/3 py-5 pt-0 px-3"},pt={class:"text-center relative"},mt={class:"mt-2"},ft={class:"text-base font-black text-primary"},vt={class:"text-xs font-bold"},xt={class:"flex flex-wrap gap-2 mt-3 justify-center"},ht={class:"text-xs mt-3 mb-3"},yt=e("hr",{class:"mt-5 mb-2"},null,-1),bt={class:"mt-4"},gt={key:0},Vt={class:"bg-white p-4 rounded",square:"",outlined:""},wt={class:"flex flex-col gap-3"},Ct=e("h2",{class:"text-sm font-bold text-primary"},"Detalle de servicio:",-1),kt={class:"flex justify-between text-xs"},jt=e("p",{class:"w-50 font-bold"},"Ruta:",-1),It={class:"flex justify-between text-xs"},zt=e("p",{class:"w-50 font-bold"},"Tipo de ruta:",-1),Tt={key:0,class:"flex justify-between text-xs"},Ot=e("p",{class:"w-50 font-bold"},"Kilometros:",-1),St={key:1,class:"flex justify-between text-xs"},Dt=e("p",{class:"w-50 font-bold"},"Nro Días:",-1),Lt={key:2,class:"flex justify-between text-xs"},Bt=e("p",{class:"w-50 font-bold"},"Pasajeros:",-1),At={key:3},Ut={key:4,class:"flex justify-between text-xs"},Et=e("p",{class:"w-50 font-bold"},"Inicio aproximado:",-1),$t={key:5,class:"flex justify-between text-xs"},qt=e("p",{class:"w-50 font-bold"},"Fin aproximado:",-1),Mt={class:"bg-white p-4 rounded mt-3",square:"",outlined:""},Nt={class:"flex flex-col gap-3"},Rt=e("h2",{class:"text-sm font-bold text-primary"},"Costo de servicio:",-1),Ft={class:"flex justify-between text-xs"},Pt=e("p",{class:"w-50 font-bold"},"Peajes:",-1),Ht={class:"flex justify-between text-xs"},Gt=e("p",{class:"w-50 font-bold"},"Vehículos:",-1),Jt={class:"flex justify-between text-xs"},Kt=e("p",{class:"w-50 font-bold"},"Viaticos:",-1),Qt={class:"flex justify-between text-xs"},Wt=e("p",{class:"w-50 font-bold"},"Monto Total:",-1),Xt={key:1,class:"bg-white p-4 rounded",square:"",outlined:""},Yt={class:"flex flex-col gap-3"},Zt={class:"inline-flex items-center rounded-md bg-primary px-2 py-1 text-xxs font-bold text-white"},es={class:"text-sm mb-1 font-semibold uppercase"},ts={class:"bg-white px-1.5 pt-2 pb-3 rounded"},ss={class:"text-xs font-semibold mb-2"},as={class:"text-xs mt-2 flex justify-between"},os=e("b",null,"Tarifa conductor:",-1),ls={class:"text-xs mt-2 mb-1 flex justify-between"},ns=e("b",null,"Cantidad:",-1),is={class:"text-xs mt-2 flex justify-between"},ds=e("b",null,"Tarifa:",-1),cs={key:2,class:"bg-white flex flex-col p-4 gap-2 rounded",square:"",outlined:""},rs={class:"flex flex-col gap-3"},us={class:"inline-flex items-center rounded-md bg-primary px-2 py-1 text-xxs font-bold text-white ring-1 ring-inset ring-gray-500/10"},_s={class:"text-xs mt-1"},ps=e("b",{class:"pr-2"},"Monto Unitario:",-1),ms={class:"bg-white px-1.5 pt-2 pb-3 mt-3 rounded"},fs={class:"text-xs font-semibold mb-2"},vs={class:"flex flex-col w-2/3"},xs={class:"bg-white p-3 mt-3"},hs={class:"new-note mt-2"},ys=e("h3",{class:"text-xs font-bold my-4 underline"},"Historial de interacciones:",-1),bs={class:"list-notes"},gs={key:0},Vs={class:"capitalize"},ws=e("p",{class:"text-sm"},"¿Deseas eliminar este comentario?",-1),Cs={class:"text-sm font-semibold text-primary"},ks=e("hr",{class:"my-3"},null,-1),js=["innerHTML"],Is=e("p",{class:"text-sm"},"¿Deseas eliminar esta orden?",-1),zs=e("p",{class:"text-xs mt-2"},[c(" Se eliminara todo el historico de esta orden, el estado de la cotización volvera a "),e("span",{class:"font-bold"},"Aprobado"),c(". ")],-1),Ts=Be({__name:"ViewOrder",setup(y){const x=m(0),v=m(null),h=Ae(),{t:he}=Ue(),a=m(null),V=m(""),b=Ee(),z=m([]),L=m([]),B=m(!1),g=m(!1),A=m(!1),T=m(!1),U=m(null),H=m(0),G=m(!1),w=m(!1),{notify:ye}=$e();qe(()=>{O(),be(),E()});const O=async()=>{const n=await Re(b.params.id);a.value={_id:`000${n.id}-24`,...n}},be=async()=>{const n=await Ke.getActives();L.value=n.map(l=>({_id:`000${l.id}-24`,...l}))},E=async()=>{const n=await We(+b.params.id);z.value=n.map(l=>({...l}))},J=n=>Qe(new Date(n),"dd/MM/yyyy hh:mm aa"),ge=async()=>{B.value=!0,await Xe({comment:V.value,quotation:+b.params.id,user:null}),await E(),V.value="",B.value=!1},Ve=async n=>{await xe(n)},we=async()=>{g.value=!0,await Fe(+b.params.id),await O(),g.value=!1},Ce=async()=>{A.value=!0,await He(+b.params.id),await O(),w.value=!1,A.value=!1,h.push("/orders")},ke=async n=>{n.loading=!0,await xe(n.id),await E(),n.loading=!1},je=async()=>{g.value=!0,await Pe(+b.params.id),await O(),g.value=!1},K=async(n,l=!1)=>{l?(n.loading=!0,await Je({expense:n.id,employee:n.employee},a.value.id),n.loading=!1):(n.loading=!0,await Ge({vehicle:n.id,employee:n.employee},a.value.id),n.loading=!1),ye({message:"Trabajador asignado correctamente",color:"success",duration:1e3})};return(n,l)=>{var Z;const Q=p("VaBadge"),f=p("VaButton"),Ie=p("VaTab"),$=p("VaCardTitle"),W=p("VaSelect"),q=p("VaCardContent"),M=p("VaCard"),ze=p("VaTabs"),Te=p("VaTextarea"),Oe=p("VaCardActions"),Se=p("VaInnerLoading"),X=p("VaListItemLabel"),Y=p("VaListItemSection"),De=p("VaListItem"),Le=p("VaAlert"),N=p("VaModal");return d(),u(I,null,[(Z=a.value)!=null&&Z._id?(d(),u("div",Ye,[e("div",null,[e("div",Ze,[e("h1",et,[c(" Orden de trabajo: "),e("span",tt,"#"+o(a.value._id),1),c(),st,e("p",at,[s(Q,{text:a.value.service.services.service,color:"primary",class:"mr-2"},null,8,["text"])])]),e("div",ot,[a.value.status!==2?(d(),u("div",lt,[s(f,{icon:"save",color:"success",loading:g.value,onClick:we},{default:t(()=>[nt]),_:1},8,["loading"]),s(f,{icon:"delete",color:"danger",loading:A.value,onClick:l[0]||(l[0]=i=>w.value=!0)},{default:t(()=>[e("span",it,o(ve(he)("actions.delete")),1)]),_:1},8,["loading"])])):_("v-if",!0),a.value.status===2?(d(),u("div",dt,[s(f,{icon:"save",color:"info",loading:g.value,onClick:je},{default:t(()=>[ct]),_:1},8,["loading"])])):_("v-if",!0)])]),rt]),e("div",ut,[e("div",_t,[e("div",pt,[e("div",mt,[e("h4",ft,o(a.value.customer.fullname),1),e("p",vt,o(a.value.customer.cellphone),1),_(` <div class="flex gap-2 justify-center mt-2">
              <VaIcon class="material-symbols-outlined cursor-pointer"> mail </VaIcon>
              <VaIcon class="material-symbols-outlined cursor-pointer"> phone </VaIcon>
            </div> `),e("div",xt,[a.value.service.specifications?(d(),j(f,{key:0,size:"small",class:"text-xxs",onClick:l[1]||(l[1]=()=>{T.value=!0,H.value=0,U.value=a.value.service.specifications})},{default:t(()=>[c(" Condiciones especificas ")]),_:1})):_("v-if",!0),_(` <VaButton
                size="small"
                class="text-xxs"
                @click="
                  () => {
                    showConditions = true
                    typeConditions = 1
                  }
                "
              >
                Condiciones
              </VaButton> `)]),e("p",ht,[s(ve(Me),{size:"14px",class:"material-symbols-outlined cursor-pointer text-green-600"},{default:t(()=>[c("adjust")]),_:1}),c(" Ultima actualización "+o(J(a.value.updated_at)),1)])])]),yt,e("div",null,[s(ze,{modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=i=>x.value=i),center:"",grow:"",class:"new-customer-tabs"},{tabs:t(()=>[(d(),u(I,null,D(["Resumen","Vehiculos","Viaticos"],i=>s(Ie,{key:i,class:"text-xs"},{default:t(()=>[c(o(i),1)]),_:2},1024)),64))]),default:t(()=>{var i,C,R,ee,te,se,ae,oe,le,ne,ie,de,ce,re,ue,_e,pe,me,fe;return[e("div",bt,[x.value==0?(d(),u("div",gt,[e("div",Vt,[e("div",wt,[Ct,e("div",kt,[jt,e("p",null,o((C=(i=a.value)==null?void 0:i.service.routes)==null?void 0:C.name),1)]),e("div",It,[zt,e("p",null,o(((R=a.value)==null?void 0:R.service.route_type)===1?"Ida y Vuelta":"Solo Ida"),1)]),(ee=a.value)!=null&&ee.service.kilometers?(d(),u("div",Tt,[Ot,e("p",null,o((te=a.value)==null?void 0:te.service.kilometers),1)])):_("v-if",!0),(se=a.value)!=null&&se.service.days?(d(),u("div",St,[Dt,e("p",null,o((ae=a.value)==null?void 0:ae.service.days),1)])):_("v-if",!0),(oe=a.value)!=null&&oe.service.passengers?(d(),u("div",Lt,[Bt,e("p",null,o((le=a.value)==null?void 0:le.service.passengers),1)])):_("v-if",!0),(ne=a.value)!=null&&ne.service.start_date?(d(),u("hr",At)):_("v-if",!0),(ie=a.value)!=null&&ie.service.start_date?(d(),u("div",Ut,[Et,e("p",null,o((de=a.value)==null?void 0:de.service.start_date),1)])):_("v-if",!0),(ce=a.value)!=null&&ce.service.end_date?(d(),u("div",$t,[qt,e("p",null,o((re=a.value)==null?void 0:re.service.end_date),1)])):_("v-if",!0)])]),e("div",Mt,[e("div",Nt,[Rt,e("div",Ft,[Pt,e("p",null,"S/ "+o((ue=a.value)==null?void 0:ue.service.total_tolls),1)]),e("div",Ht,[Gt,e("p",null,"S/ "+o((_e=a.value)==null?void 0:_e.service.total_vehicles),1)]),e("div",Jt,[Kt,e("p",null,"S/ "+o((pe=a.value)==null?void 0:pe.service.total_expenses),1)]),e("div",Qt,[Wt,e("p",null,"S/ "+o((me=a.value)==null?void 0:me.service.total),1)])])])])):_("v-if",!0),x.value==1?(d(),u("div",Xt,[e("div",Yt,[(d(!0),u(I,null,D((fe=a.value)==null?void 0:fe.vehicles,r=>(d(),j(M,{key:r,color:"#eff6ff"},{default:t(()=>[s($,{class:"capitalize"},{default:t(()=>[e("span",Zt,o(r.passengers)+" Pasajeros ",1)]),_:2},1024),s(q,null,{default:t(()=>[e("p",es,o(r.detail.name),1),e("div",ts,[e("p",ss,o(r.typedriver),1),s(W,{modelValue:r.employee,"onUpdate:modelValue":k=>r.employee=k,placeholder:"Selecciona un trabajador",class:"text-xss","search-placeholder-text":"Buscar","text-by":"names","value-by":"id",options:L.value,searchable:"","highlight-matched-text":""},null,8,["modelValue","onUpdate:modelValue","options"]),s(f,{size:"small",class:"mr-6 mt-3 text-xxs",disabled:!r.employee,loading:r.loading,onClick:k=>K(r)},{default:t(()=>[c(" Asignar conductor ")]),_:2},1032,["disabled","loading","onClick"])]),e("p",as,[os,c(" S/ "+o(r.driverfee),1)]),e("p",ls,[ns,c(" "+o(r.quantity)+" Unidades",1)]),e("p",is,[ds,c(" S/ "+o(r.total),1)])]),_:2},1024)]),_:2},1024))),128))])])):_("v-if",!0),x.value==2?(d(),u("div",cs,[e("div",rs,[(d(!0),u(I,null,D(a.value.service.expenses,r=>(d(),j(M,{key:r,color:"#eff6ff"},{default:t(()=>[s($,{class:"capitalize"},{default:t(()=>[e("span",us,o(r.name),1)]),_:2},1024),s(q,null,{default:t(()=>[_(' <p class="text-xs mt-1 flex"><b class="pr-3">Cantidad:</b> {{ i.quantity }}</p> '),e("p",_s,[ps,c(" S/ "+o(r.amount),1)]),e("div",ms,[e("p",fs,o(r.typedriver),1),s(W,{modelValue:r.employee,"onUpdate:modelValue":k=>r.employee=k,placeholder:"Selecciona un trabajador",class:"text-xss","search-placeholder-text":"Buscar","text-by":"names","value-by":"id",options:L.value,searchable:"","highlight-matched-text":""},null,8,["modelValue","onUpdate:modelValue","options"]),s(f,{size:"small",class:"mr-6 mt-3 text-xxs",disabled:!r.employee,loading:r.loading,onClick:k=>K(r,!0)},{default:t(()=>[c(" Asignar trabajador ")]),_:2},1032,["disabled","loading","onClick"])])]),_:2},1024)]),_:2},1024))),128))])])):_("v-if",!0)])]}),_:1},8,["modelValue"])])]),e("section",vs,[e("div",xs,[e("div",hs,[s(Se,{loading:B.value},{default:t(()=>[s(M,{color:"#eff6ff"},{default:t(()=>[s($,null,{default:t(()=>[c("Registrar un comentario")]),_:1}),s(q,null,{default:t(()=>[s(Te,{modelValue:V.value,"onUpdate:modelValue":l[3]||(l[3]=i=>V.value=i),class:"w-full",background:"#fff",clearable:""},null,8,["modelValue"])]),_:1}),s(Oe,{align:"right"},{default:t(()=>[s(f,{disabled:!V.value,onClick:ge},{default:t(()=>[c("Registrar comentario")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["loading"])]),ys,e("div",bs,[z.value.length?(d(),u("div",gs,[(d(!0),u(I,null,D(z.value,(i,C)=>(d(),j(De,{key:C,class:"list__item mt-3 bg-blue-50 px-2 py-3 rounded-md"},{default:t(()=>[s(Y,null,{default:t(()=>[s(X,{class:"flex justify-between text-primary font-bold text-xs"},{default:t(()=>[e("span",Vs,o(i.creator.name),1),s(Q,{text:J(i.created_at),color:"#fff",class:"ml-3"},null,8,["text"])]),_:2},1024),s(X,{class:"text-black pt-2 text-xs",caption:"",lines:C+10},{default:t(()=>[c(o(i.comment),1)]),_:2},1032,["lines"])]),_:2},1024),s(Y,{icon:""},{default:t(()=>[s(f,{round:"",class:"cursor-pointer",color:"danger",icon:"delete",loading:i.loading,onClick:R=>ke(i)},null,8,["loading","onClick"])]),_:2},1024)]),_:2},1024))),128))])):_("v-if",!0),z.value.length?_("v-if",!0):(d(),j(Le,{key:1,class:"text-xs",color:"#fdeae7","text-color":"#940909"},{default:t(()=>[c(" No existe actividad en esta orden. ")]),_:1}))])])])])])):_("v-if",!0),s(N,{modelValue:v.value,"onUpdate:modelValue":l[5]||(l[5]=i=>v.value=i),size:"250px","hide-default-actions":"","no-dismiss":""},{footer:t(()=>[s(f,{size:"small",preset:"secondary",class:"mr-1",onClick:l[4]||(l[4]=i=>v.value=null)},{default:t(()=>[c(" Cancelar")]),_:1}),s(f,{size:"small",loading:G.value,onClick:Ve},{default:t(()=>[c(" Continuar")]),_:1},8,["loading"])]),default:t(()=>[ws]),_:1},8,["modelValue"]),s(N,{modelValue:T.value,"onUpdate:modelValue":l[7]||(l[7]=i=>T.value=i),size:"600px","hide-default-actions":"","no-dismiss":""},{footer:t(()=>[s(f,{size:"small",preset:"secondary",class:"mr-1",onClick:l[6]||(l[6]=()=>{T.value=!1,U.value=""})},{default:t(()=>[c(" Cerrar condiciones")]),_:1})]),default:t(()=>[e("p",Cs,o(H.value?"Condiciones Generales":"Condiciones Especificas"),1),ks,e("div",{class:"py-3 px-2 text-xs bg-white rounded",innerHTML:U.value},null,8,js)]),_:1},8,["modelValue"]),s(N,{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]=i=>w.value=i),size:"250px","hide-default-actions":"","no-dismiss":""},{footer:t(()=>[s(f,{size:"small",preset:"secondary",class:"mr-1",onClick:l[8]||(l[8]=i=>w.value=!1)},{default:t(()=>[c(" Cancelar")]),_:1}),s(f,{size:"small",loading:G.value,onClick:Ce},{default:t(()=>[c(" Continuar")]),_:1},8,["loading"])]),default:t(()=>[Is,zs]),_:1},8,["modelValue"])],64)}}});const Bs=Ne(Ts,[["__file","C:/Users/ID-04/Documents/Main/vuestic-impala/src/pages/orders/pages/ViewOrder.vue"]]);export{Bs as default};
//# sourceMappingURL=ViewOrder-e7784e32.js.map
